# Travel AI ç”¨æˆ·ç™»å½•æ³¨å†ŒæŠ€æœ¯å®ç°æ–‡æ¡£

**æ–‡æ¡£ç¼–å·**: 0906-ç”¨æˆ·ç™»å½•æ³¨å†ŒæŠ€æœ¯  
**åˆ›å»ºæ—¥æœŸ**: 2025å¹´09æœˆ06æ—¥  
**ç‰ˆæœ¬**: v1.0  
**é¡¹ç›®**: Travel AI (gitagent01-main)

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

Travel AI é¡¹ç›®é‡‡ç”¨ **Supabase Auth** ä½œä¸ºä¸»è¦è®¤è¯ç³»ç»Ÿï¼Œç»“åˆ **FastAPI** åç«¯å’Œ **React** å‰ç«¯ï¼Œå®ç°äº†å®Œæ•´çš„ç”¨æˆ·ç™»å½•æ³¨å†ŒåŠŸèƒ½ã€‚ç³»ç»Ÿæ”¯æŒé‚®ç®±å¯†ç è®¤è¯ã€JWTä»¤ç‰Œç®¡ç†ã€å¤šè¯­è¨€ç•Œé¢ï¼Œå¹¶é›†æˆäº†å®Œæ•´çš„ç”¨æˆ·çŠ¶æ€ç®¡ç†ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (React)   â”‚    â”‚   åç«¯ (FastAPI) â”‚    â”‚  æ•°æ®åº“ (Supabase) â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ AuthContext â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ Auth API    â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ Auth Serviceâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Auth UI     â”‚ â”‚    â”‚ â”‚ JWT Handler â”‚ â”‚    â”‚ â”‚ PostgreSQL  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Supabase    â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ User API    â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ User Tables â”‚ â”‚
â”‚ â”‚ Client      â”‚ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¤è¯æµç¨‹
1. **ç”¨æˆ·æ³¨å†Œ/ç™»å½•** â†’ Supabase Auth
2. **JWTä»¤ç‰Œç”Ÿæˆ** â†’ Supabase Auth Service
3. **å‰ç«¯çŠ¶æ€ç®¡ç†** â†’ AuthContext + Zustand Store
4. **APIè¯·æ±‚è®¤è¯** â†’ Bearer Token
5. **åç«¯éªŒè¯** â†’ JWTéªŒè¯ä¸­é—´ä»¶

## ğŸ—„ï¸ æ•°æ®åº“é…ç½®

### æ•°æ®åº“è¿æ¥é…ç½®
**æ–‡ä»¶**: `backend/app/db/database.py`
```python
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from ..core.config import settings

# åˆ›å»ºæ•°æ®åº“å¼•æ“
engine = create_engine(settings.database_url)

# åˆ›å»ºä¼šè¯å·¥å‚
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

# åˆ›å»ºåŸºç¡€æ¨¡å‹ç±»
Base = declarative_base()

def get_db():
    """è·å–æ•°æ®åº“ä¼šè¯"""
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
```

### æ•°æ®åº“é…ç½®å‚æ•°
**æ–‡ä»¶**: `backend/app/core/config.py`
```python
class Settings(BaseSettings):
    # æ•°æ®åº“é…ç½®
    database_url: str = (
        "postgresql://dev_user:dev_password@localhost:5432/travel_ai_dev"
    )
    
    # Supabaseé…ç½®
    supabase_url: Optional[str] = None
    supabase_service_key: Optional[str] = None
    
    # JWTé…ç½®
    secret_key: str = "your-secret-key-change-in-production"
    algorithm: str = "HS256"
    access_token_expire_minutes: int = 1440  # 24å°æ—¶
```

### æ•°æ®åº“è¡¨ç»“æ„
**æ–‡ä»¶**: `backend/sql/init.sql`

#### ç”¨æˆ·è¡¨ (åŸºäºSupabase Auth)
```sql
CREATE TABLE IF NOT EXISTS public.users (
    id UUID NOT NULL DEFAULT auth.uid(),
    email TEXT NOT NULL,
    display_name TEXT NULL,
    avatar_url TEXT NULL,
    provider TEXT NOT NULL DEFAULT 'email'::TEXT,
    created_at TIMESTAMP WITH TIME ZONE NULL DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE NULL DEFAULT NOW(),
    last_sign_in TIMESTAMP WITH TIME ZONE NULL DEFAULT NOW(),
    preferences JSON NULL DEFAULT '{}'::JSON,
    CONSTRAINT users_pkey PRIMARY KEY (id),
    CONSTRAINT users_email_key UNIQUE (email)
);
```

#### ç›¸å…³ä¸šåŠ¡è¡¨
- **conversations**: å¯¹è¯ä¼šè¯è¡¨
- **messages**: æ¶ˆæ¯è¡¨
- **travel_plans**: æ—…è¡Œè®¡åˆ’è¡¨
- **destinations**: ç›®çš„åœ°æ•°æ®è¡¨

## ğŸ” åç«¯è®¤è¯å®ç°

### è®¤è¯APIè·¯ç”±
**æ–‡ä»¶**: `backend/app/api/auth.py`

#### ç™»å½•æ¥å£
```python
@router.post("/login", response_model=Token)
async def login(user_credentials: UserLogin):
    """ç”¨æˆ·ç™»å½•"""
    # æ¨¡æ‹Ÿç”¨æˆ·éªŒè¯
    if user_credentials.email == "demo@example.com" and user_credentials.password == "demo123":
        fake_token = "fake-jwt-token-for-demo"
        return {
            "access_token": fake_token,
            "token_type": "bearer",
            "expires_in": settings.access_token_expire_minutes * 60,
            "user_id": "demo-user-123"
        }
    else:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯",
            headers={"WWW-Authenticate": "Bearer"},
        )
```

#### æ³¨å†Œæ¥å£
```python
@router.post("/register", response_model=Dict[str, Any])
async def register(user_data: UserRegister):
    """ç”¨æˆ·æ³¨å†Œ"""
    # TODO: å®ç°ç”¨æˆ·æ³¨å†Œé€»è¾‘
    return {
        "message": "ç”¨æˆ·æ³¨å†ŒæˆåŠŸ",
        "user_id": "new-user-123",
        "username": user_data.username
    }
```

#### è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
```python
@router.get("/me")
async def get_current_user(credentials: HTTPAuthorizationCredentials = Depends(security)):
    # TODO: éªŒè¯JWT tokenå¹¶è¿”å›ç”¨æˆ·ä¿¡æ¯
    if credentials.credentials == "fake-jwt-token-for-demo":
        return {
            "user_id": "demo-user-123",
            "username": "demo",
            "email": "demo@example.com",
            "created_at": datetime.now().isoformat()
        }
    else:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="æ— æ•ˆçš„è®¤è¯ä»¤ç‰Œ",
            headers={"WWW-Authenticate": "Bearer"},
        )
```

### æ•°æ®æ¨¡å‹å®šä¹‰
**æ–‡ä»¶**: `backend/app/schemas/auth.py`

```python
class UserLogin(BaseModel):
    """ç”¨æˆ·ç™»å½•è¯·æ±‚"""
    email: EmailStr
    password: str

class UserRegister(BaseModel):
    """ç”¨æˆ·æ³¨å†Œè¯·æ±‚"""
    username: str
    email: EmailStr
    password: str
    confirm_password: str

class Token(BaseModel):
    """JWTä»¤ç‰Œå“åº”"""
    access_token: str
    token_type: str
    expires_in: int
    user_id: str
```

## ğŸŒ å‰ç«¯è®¤è¯å®ç°

### Supabaseå®¢æˆ·ç«¯é…ç½®
**æ–‡ä»¶**: `frontend/src/lib/supabase.ts`

```typescript
import { createClient } from '@supabase/supabase-js';
import type { Database } from '../types/supabase';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

export const supabase = createClient<Database>(
  supabaseUrl,
  supabaseAnonKey,
  {
    auth: {
      flowType: 'pkce',              // ä½¿ç”¨PKCEæµç¨‹å¢å¼ºå®‰å…¨æ€§
      persistSession: true,          // æŒä¹…åŒ–ä¼šè¯
      autoRefreshToken: true,        // è‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œ
      detectSessionInUrl: true,      // è‡ªåŠ¨æ£€æµ‹URLä¸­çš„ä¼šè¯å‚æ•°
      storage: {
        getItem: (key) => localStorage.getItem(key),
        setItem: (key, value) => localStorage.setItem(key, value),
        removeItem: (key) => {
          localStorage.removeItem(key);
          sessionStorage.removeItem(key);
        }
      }
    }
  }
);
```

### è®¤è¯ä¸Šä¸‹æ–‡ç®¡ç†
**æ–‡ä»¶**: `frontend/src/context/AuthContext.tsx`

#### æ ¸å¿ƒåŠŸèƒ½
```typescript
interface AuthContextType {
  isAuthenticated: boolean;
  user: User | null;
  signIn: (email: string, password: string) => Promise<void>;
  signUp: (email: string, password: string) => Promise<void>;
  signOut: () => Promise<void>;
  resetPassword: (email: string) => Promise<void>;
  error: string | null;
  isLoading: boolean;
}
```

#### ç™»å½•å®ç°
```typescript
const signIn = async (email: string, password: string) => {
  try {
    setError(null);
    setIsLoading(true);
    
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password,
    });
    
    if (error) throw error;
    
    console.log('[AuthContext] âœ… ç™»å½•æˆåŠŸ', { 
      userId: data.user?.id,
      email: data.user?.email 
    });
    
    syncUserState(data.user, true);
  } catch (error: any) {
    console.error('[AuthContext] âŒ ç™»å½•å¤±è´¥', error);
    setError(error.message || 'ç™»å½•å¤±è´¥');
    throw error;
  } finally {
    setIsLoading(false);
  }
};
```

#### æ³¨å†Œå®ç°
```typescript
const signUp = async (email: string, password: string) => {
  try {
    setError(null);
    setIsLoading(true);
    
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
    });
    
    if (error) throw error;
    
    console.log('[AuthContext] âœ… æ³¨å†ŒæˆåŠŸ', { 
      userId: data.user?.id,
      email: data.user?.email 
    });
    
    // æ³¨å†ŒæˆåŠŸåéœ€è¦é‚®ç®±éªŒè¯
    if (data.user && !data.session) {
      message.success('æ³¨å†ŒæˆåŠŸï¼è¯·æ£€æŸ¥é‚®ç®±éªŒè¯é“¾æ¥');
    } else {
      syncUserState(data.user, true);
    }
  } catch (error: any) {
    console.error('[AuthContext] âŒ æ³¨å†Œå¤±è´¥', error);
    setError(error.message || 'æ³¨å†Œå¤±è´¥');
    throw error;
  } finally {
    setIsLoading(false);
  }
};
```

### è®¤è¯UIç»„ä»¶

#### ç™»å½•é¡µé¢ç»„ä»¶
**æ–‡ä»¶**: `frontend/src/components/Auth.tsx`

```typescript
const LoginForm = () => (
  <Form
    name="login"
    onFinish={handleLogin}
    autoComplete="off"
    layout="vertical"
    size="large"
  >
    <Form.Item
      name="email"
      label={t('auth.emailPlaceholder')}
      rules={[
        { required: true, message: t('auth.validation.emailRequired') },
        { type: 'email', message: t('auth.validation.emailInvalid') }
      ]}
    >
      <Input
        prefix={<MailOutlined />}
        placeholder={t('auth.emailPlaceholder')}
        type="email"
      />
    </Form.Item>

    <Form.Item
      name="password"
      label={t('auth.passwordPlaceholder')}
      rules={[{ required: true, message: t('auth.validation.passwordRequired') }]}
    >
      <Input.Password
        prefix={<LockOutlined />}
        placeholder={t('auth.passwordPlaceholder')}
      />
    </Form.Item>

    <Form.Item>
      <Button
        type="primary"
        htmlType="submit"
        loading={isLoading}
        className="w-full bg-blue-500 hover:bg-blue-600"
        icon={<LogIn className="w-4 h-4" />}
      >
        {t('auth.login')}
      </Button>
    </Form.Item>
  </Form>
);
```

#### æ³¨å†Œé¡µé¢ç»„ä»¶
```typescript
const RegisterForm = () => (
  <Form
    name="register"
    onFinish={handleRegister}
    autoComplete="off"
    layout="vertical"
    size="large"
  >
    <Form.Item
      name="email"
      label={t('auth.emailPlaceholder')}
      rules={[
        { required: true, message: t('auth.validation.emailRequired') },
        { type: 'email', message: t('auth.validation.emailInvalid') }
      ]}
    >
      <Input
        prefix={<MailOutlined />}
        placeholder={t('auth.emailPlaceholder')}
        type="email"
      />
    </Form.Item>

    <Form.Item
      name="password"
      label={t('auth.passwordPlaceholder')}
      rules={[
        { required: true, message: t('auth.validation.passwordRequired') },
        { min: 6, message: t('auth.validation.passwordTooShort') }
      ]}
    >
      <Input.Password
        prefix={<LockOutlined />}
        placeholder={t('auth.passwordPlaceholder')}
      />
    </Form.Item>

    <Form.Item
      name="confirmPassword"
      label={t('auth.confirmPasswordPlaceholder')}
      rules={[
        { required: true, message: t('auth.validation.passwordConfirmRequired') },
        ({ getFieldValue }) => ({
          validator(_, value) {
            if (!value || getFieldValue('password') === value) {
              return Promise.resolve();
            }
            return Promise.reject(new Error(t('auth.passwordMismatch')));
          },
        }),
      ]}
    >
      <Input.Password
        prefix={<LockOutlined />}
        placeholder={t('auth.confirmPasswordPlaceholder')}
      />
    </Form.Item>

    <Form.Item>
      <Button
        type="primary"
        htmlType="submit"
        loading={isLoading}
        className="w-full bg-green-500 hover:bg-green-600"
        icon={<UserPlus className="w-4 h-4" />}
      >
        {t('auth.register')}
      </Button>
    </Form.Item>
  </Form>
);
```

### APIæœåŠ¡å±‚
**æ–‡ä»¶**: `frontend/src/services/api.ts`

```typescript
// åˆ›å»ºaxioså®ä¾‹
const api = axios.create({
  baseURL: '/api/v1',
  timeout: 10000,
})

// è¯·æ±‚æ‹¦æˆªå™¨ - æ·»åŠ è®¤è¯token
api.interceptors.request.use((config) => {
  const token = localStorage.getItem('access_token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// å“åº”æ‹¦æˆªå™¨ - å¤„ç†é”™è¯¯
api.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      localStorage.removeItem('access_token')
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)

// è®¤è¯API
export const authAPI = {
  login: async (credentials: LoginCredentials): Promise<AuthToken> => {
    const response = await api.post('/auth/login', credentials)
    return response.data
  },
  
  register: async (data: RegisterData) => {
    const response = await api.post('/auth/register', data)
    return response.data
  },
  
  getCurrentUser: async (): Promise<User> => {
    const response = await api.get('/auth/me')
    return response.data
  },
}
```

## ğŸ”§ ç±»å‹å®šä¹‰

### Supabaseæ•°æ®åº“ç±»å‹
**æ–‡ä»¶**: `frontend/src/types/supabase.ts`

```typescript
export interface Database {
  public: {
    Tables: {
      users: {
        Row: {
          id: string
          email: string
          display_name: string | null
          avatar_url: string | null
          provider: string
          created_at: string | null
          updated_at: string | null
          last_sign_in: string | null
          preferences: Json | null
        }
        Insert: {
          id?: string
          email: string
          display_name?: string | null
          avatar_url?: string | null
          provider?: string
          created_at?: string | null
          updated_at?: string | null
          last_sign_in?: string | null
          preferences?: Json | null
        }
        Update: {
          id?: string
          email?: string
          display_name?: string | null
          avatar_url?: string | null
          provider?: string
          created_at?: string | null
          updated_at?: string | null
          last_sign_in?: string | null
          preferences?: Json | null
        }
        Relationships: []
      }
      // ... å…¶ä»–è¡¨å®šä¹‰
    }
  }
}
```

## ğŸš€ éƒ¨ç½²é…ç½®

### ç¯å¢ƒå˜é‡é…ç½®
**æ–‡ä»¶**: `.env`

```bash
# Supabaseé…ç½®
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key

# åç«¯é…ç½®
DATABASE_URL=postgresql://user:password@localhost:5432/travel_ai
SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_KEY=your_supabase_service_key
SECRET_KEY=your_secret_key
```

### å¯åŠ¨å‘½ä»¤
```bash
# å¯åŠ¨åç«¯
cd backend
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

# å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# æˆ–ä½¿ç”¨Netlify
npx netlify dev --port 8888
```

## ğŸ“Š æŠ€æœ¯ç‰¹æ€§

### å®‰å…¨ç‰¹æ€§
- âœ… **PKCEæµç¨‹**: å¢å¼ºOAuthå®‰å…¨æ€§
- âœ… **JWTä»¤ç‰Œ**: æ— çŠ¶æ€è®¤è¯
- âœ… **è‡ªåŠ¨åˆ·æ–°**: ä»¤ç‰Œè‡ªåŠ¨ç»­æœŸ
- âœ… **HTTPS**: ä¼ è¾“åŠ å¯†
- âœ… **è¾“å…¥éªŒè¯**: å‰åç«¯åŒé‡éªŒè¯
- âœ… **é”™è¯¯å¤„ç†**: ç»Ÿä¸€é”™è¯¯å¤„ç†æœºåˆ¶

### ç”¨æˆ·ä½“éªŒ
- âœ… **å¤šè¯­è¨€æ”¯æŒ**: 16ç§è¯­è¨€ç•Œé¢
- âœ… **å“åº”å¼è®¾è®¡**: ç§»åŠ¨ç«¯é€‚é…
- âœ… **åŠ è½½çŠ¶æ€**: ç”¨æˆ·å‹å¥½çš„åŠ è½½æç¤º
- âœ… **é”™è¯¯æç¤º**: æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- âœ… **è¡¨å•éªŒè¯**: å®æ—¶è¡¨å•éªŒè¯
- âœ… **çŠ¶æ€æŒä¹…åŒ–**: ç™»å½•çŠ¶æ€ä¿æŒ

### å¼€å‘ç‰¹æ€§
- âœ… **TypeScript**: ç±»å‹å®‰å…¨
- âœ… **æ¨¡å—åŒ–**: ç»„ä»¶åŒ–å¼€å‘
- âœ… **çŠ¶æ€ç®¡ç†**: Context + Zustand
- âœ… **APIå°è£…**: ç»Ÿä¸€çš„APIè°ƒç”¨
- âœ… **é”™è¯¯è¾¹ç•Œ**: é”™è¯¯éš”ç¦»
- âœ… **æ—¥å¿—è®°å½•**: å®Œæ•´çš„æ“ä½œæ—¥å¿—

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Supabaseè¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $VITE_SUPABASE_URL
echo $VITE_SUPABASE_ANON_KEY

# æ£€æŸ¥ç½‘ç»œè¿æ¥
curl -I https://your-project.supabase.co
```

#### 2. è®¤è¯çŠ¶æ€ä¸åŒæ­¥
```typescript
// æ£€æŸ¥AuthContextçŠ¶æ€
console.log('è®¤è¯çŠ¶æ€:', { isAuthenticated, user, error, isLoading });

// æ‰‹åŠ¨åˆ·æ–°è®¤è¯çŠ¶æ€
await supabase.auth.getSession();
```

#### 3. JWTä»¤ç‰Œè¿‡æœŸ
```typescript
// æ£€æŸ¥ä»¤ç‰Œæœ‰æ•ˆæ€§
const token = localStorage.getItem('access_token');
if (token) {
  const payload = JSON.parse(atob(token.split('.')[1]));
  const isExpired = payload.exp * 1000 < Date.now();
  console.log('ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ:', isExpired);
}
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–
- **æ‡’åŠ è½½**: ç»„ä»¶æŒ‰éœ€åŠ è½½
- **ç¼“å­˜ç­–ç•¥**: åˆç†ä½¿ç”¨localStorage
- **é˜²æŠ–å¤„ç†**: è¾“å…¥é˜²æŠ–ä¼˜åŒ–
- **é”™è¯¯è¾¹ç•Œ**: é˜²æ­¢åº”ç”¨å´©æºƒ

### åç«¯ä¼˜åŒ–
- **è¿æ¥æ± **: æ•°æ®åº“è¿æ¥å¤ç”¨
- **ç¼“å­˜æœºåˆ¶**: Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- **å¼‚æ­¥å¤„ç†**: éé˜»å¡IOæ“ä½œ
- **æ—¥å¿—ä¼˜åŒ–**: ç»“æ„åŒ–æ—¥å¿—è®°å½•

## ğŸ¯ æœªæ¥è§„åˆ’

### çŸ­æœŸç›®æ ‡
- [ ] å®Œå–„JWTä»¤ç‰ŒéªŒè¯
- [ ] å®ç°å¯†ç é‡ç½®åŠŸèƒ½
- [ ] æ·»åŠ ç¤¾äº¤ç™»å½•æ”¯æŒ
- [ ] ä¼˜åŒ–é”™è¯¯å¤„ç†æœºåˆ¶

### é•¿æœŸç›®æ ‡
- [ ] å®ç°å¤šå› ç´ è®¤è¯
- [ ] æ·»åŠ ç”¨æˆ·æƒé™ç®¡ç†
- [ ] æ”¯æŒå•ç‚¹ç™»å½•(SSO)
- [ ] å®ç°å®¡è®¡æ—¥å¿—åŠŸèƒ½

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Supabase Authæ–‡æ¡£](https://supabase.com/docs/guides/auth)
- [FastAPIè®¤è¯æ–‡æ¡£](https://fastapi.tiangolo.com/tutorial/security/)
- [React Contextæ–‡æ¡£](https://react.dev/reference/react/createContext)
- [JWTæ ‡å‡†è§„èŒƒ](https://tools.ietf.org/html/rfc7519)

---

**æ–‡æ¡£ç»´æŠ¤**: æŠ€æœ¯å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025å¹´09æœˆ06æ—¥  
**ç‰ˆæœ¬**: v1.0
