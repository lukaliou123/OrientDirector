# ğŸ—ºï¸ OrientDirector åœ°å›¾å¯¼èˆªç›¸å†Œçš„æ•°æ®å­˜å‚¨ç»“æ„å’Œè·å–æ–¹å¼

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†OrientDirectoré¡¹ç›®ä¸­åœ°å›¾å¯¼èˆªç›¸å†ŒåŠŸèƒ½çš„æ•°æ®å­˜å‚¨ç»“æ„ã€è·å–æ–¹å¼å’Œç®¡ç†æœºåˆ¶ã€‚è¯¥ç³»ç»Ÿæ”¯æŒå…¨çƒåŸå¸‚æ™¯ç‚¹æ•°æ®ç®¡ç†ã€å›¾ç‰‡èµ„æºå­˜å‚¨ã€ä»¥åŠå‰åç«¯æ•°æ®äº¤äº’ã€‚

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**: 2025å¹´9æœˆ8æ—¥  
**åŸºäºç‰ˆæœ¬**: hw01åˆ†æ”¯ (æäº¤: f29a2e5)  
**æ•°æ®æ¥æº**: ä»£ç åˆ†æå’Œå®é™…è¿è¡Œæ—¥å¿—

---

## ğŸ—ï¸ æ•°æ®å­˜å‚¨æ¶æ„

### 1. æ•´ä½“æ¶æ„å›¾

```
OrientDirector/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ journeys.json              # åŒ—äº¬æ™¯ç‚¹è¯¦ç»†æ•°æ®
â”‚   â”œâ”€â”€ doro/
â”‚   â”‚   â”œâ”€â”€ preset/                    # é¢„è®¾Doroå½¢è±¡å›¾ç‰‡
â”‚   â”‚   â””â”€â”€ custom/                    # ç”¨æˆ·è‡ªå®šä¹‰Doroå›¾ç‰‡
â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â””â”€â”€ images/                    # é™æ€å›¾ç‰‡èµ„æº
â”‚   â”œâ”€â”€ generated_images/              # AIç”Ÿæˆçš„å›¾ç‰‡
â”‚   â”œâ”€â”€ generated_videos/              # AIç”Ÿæˆçš„è§†é¢‘
â”‚   â”œâ”€â”€ global_cities_db.py           # å…¨çƒåŸå¸‚æ•°æ®åº“
â”‚   â”œâ”€â”€ local_attractions_db.py       # æœ¬åœ°æ™¯ç‚¹æ•°æ®åº“
â”‚   â”œâ”€â”€ media_service.py              # åª’ä½“èµ„æºç®¡ç†
â”‚   â””â”€â”€ doro_service.py               # Doroå½¢è±¡ç®¡ç†
â””â”€â”€ frontend/
    â”œâ”€â”€ app.js                        # å‰ç«¯æ•°æ®å¤„ç†é€»è¾‘
    â””â”€â”€ index.html                    # ç•Œé¢å±•ç¤º
```

---

## ğŸ“Š æ•°æ®å­˜å‚¨ç»“æ„

### 1. å…¨çƒåŸå¸‚æ•°æ®åº“ (`global_cities_db.py`)

#### æ•°æ®ç»“æ„
```python
class GlobalCitiesDB:
    def __init__(self):
        self.global_cities = {
            "paris": {
                "name": "å·´é»",
                "country": "æ³•å›½", 
                "coordinates": [48.8566, 2.3522],
                "attractions": [
                    {
                        "name": "åŸƒè²å°”é“å¡”",
                        "latitude": 48.8584,
                        "longitude": 2.2945,
                        "category": "åœ°æ ‡å»ºç­‘",
                        "description": "å·´é»çš„è±¡å¾ï¼Œä¸–ç•Œè‘—åçš„é“å¡”å»ºç­‘...",
                        "opening_hours": "09:30-23:45",
                        "ticket_price": "æˆäººç¥¨ï¼š29.4æ¬§å…ƒ",
                        "booking_method": "å®˜æ–¹ç½‘ç«™é¢„çº¦",
                        "image": "https://images.unsplash.com/photo-...",
                        "video": "https://www.youtube.com/watch?v=...",
                        "country": "æ³•å›½",
                        "city": "å·´é»",
                        "address": "Champ de Mars, 5 Avenue Anatole France..."
                    }
                ]
            }
        }
```

#### æ”¯æŒçš„åŸå¸‚
- **æ¬§æ´²**: å·´é»ã€ä¼¦æ•¦ã€ç½—é©¬ã€é˜¿å§†æ–¯ç‰¹ä¸¹ã€å·´å¡ç½—é‚£ã€ç»´ä¹Ÿçº³ã€å¸ƒæ‹‰æ ¼
- **äºšæ´²**: ä¸œäº¬ã€é¦–å°”ã€æ–°åŠ å¡ã€æ›¼è°·ã€å‰éš†å¡ã€é›…åŠ è¾¾
- **ç¾æ´²**: çº½çº¦ã€æ´›æ‰çŸ¶ã€å¤šä¼¦å¤šã€æ¸©å“¥å
- **å¤§æ´‹æ´²**: æ‚‰å°¼ã€å¢¨å°”æœ¬
- **ä¸­å›½**: åŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·ã€æ·±åœ³ã€æ­å·ã€æˆéƒ½ã€è¥¿å®‰ã€å—äº¬

### 2. æœ¬åœ°æ™¯ç‚¹æ•°æ®åº“ (`local_attractions_db.py`)

#### æ•°æ®ç»“æ„
```python
class LocalAttractionsDB:
    def __init__(self):
        self.attractions = [
            {
                "name": "æ•…å®«åšç‰©é™¢",
                "latitude": 39.9163,
                "longitude": 116.3972,
                "category": "æ–‡åŒ–å¤è¿¹",
                "description": "ä¸­å›½æ˜æ¸…ä¸¤ä»£çš„çš‡å®¶å®«æ®¿...",
                "opening_hours": "08:30-17:00",
                "ticket_price": "æˆäººç¥¨ï¼š60å…ƒ",
                "booking_method": "å®˜æ–¹ç½‘ç«™å®åé¢„çº¦",
                "image": "data:image/svg+xml;base64,...",  # Base64ç¼–ç çš„SVG
                "video": None,
                "country": "ä¸­å›½",
                "city": "åŒ—äº¬å¸‚ä¸œåŸåŒº",
                "address": "åŒ—äº¬å¸‚ä¸œåŸåŒºæ™¯å±±å‰è¡—4å·"
            }
        ]
```

#### åŒ—äº¬æ™¯ç‚¹æ•°æ® (22ä¸ªç²¾é€‰æ™¯ç‚¹)
- **æ–‡åŒ–å¤è¿¹**: æ•…å®«ã€å¤©å›ã€é¢å’Œå›­ã€é›å’Œå®«ã€æ­ç‹åºœç­‰ (14ä¸ª)
- **ç°ä»£å»ºç­‘**: é¸Ÿå·¢ã€æ°´ç«‹æ–¹ (2ä¸ª)
- **ä¼‘é—²å¨±ä¹**: åŒ—æµ·å…¬å›­ã€æ™¯å±±å…¬å›­ (2ä¸ª)
- **è‡ªç„¶æ™¯è§‚**: é¦™å±±å…¬å›­ (1ä¸ª)
- **ç°ä»£è‰ºæœ¯**: 798è‰ºæœ¯åŒº (1ä¸ª)

### 3. è¯¦ç»†æ™¯ç‚¹æ•°æ® (`data/journeys.json`)

#### æ•°æ®ç»“æ„
```json
{
  "beijing_top_attractions": {
    "description": "åŒ—äº¬TOP 22ç²¾é€‰æ™¯ç‚¹æ•°æ®åº“",
    "last_updated": "2025-09-02",
    "total_attractions": 22,
    "categories": {
      "æ–‡åŒ–å¤è¿¹": 14,
      "ä¼‘é—²å¨±ä¹": 2,
      "ç°ä»£å»ºç­‘": 2,
      "è‡ªç„¶æ™¯è§‚": 1,
      "ç°ä»£è‰ºæœ¯": 1
    },
    "attractions": {
      "forbidden_city": {
        "id": "forbidden_city",
        "name": "æ•…å®«åšç‰©é™¢",
        "category": "æ–‡åŒ–å¤è¿¹",
        "coordinates": {"lat": 39.9163, "lng": 116.3972},
        "address": "åŒ—äº¬å¸‚ä¸œåŸåŒºæ™¯å±±å‰è¡—4å·",
        "description": "ä¸­å›½æ˜æ¸…ä¸¤ä»£çš„çš‡å®¶å®«æ®¿...",
        "opening_hours": "08:30-17:00",
        "ticket_price": "æˆäººç¥¨ï¼š60å…ƒ",
        "rating": 4.8,
        "photos": [
          "https://images.unsplash.com/photo-1548013146-72479768bada?w=800",
          "https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=800",
          "https://images.unsplash.com/photo-1584464491033-06628f3a6b7b?w=800"
        ],
        "video": "https://www.youtube.com/watch?v=WibmcsEGLKo",
        "highlights": ["å¤ªå’Œæ®¿", "ä¹¾æ¸…å®«", "å¾¡èŠ±å›­", "çå®é¦†"],
        "visit_duration": "4-6å°æ—¶",
        "best_visit_time": "æ˜¥ç§‹å­£èŠ‚ï¼Œé¿å¼€èŠ‚å‡æ—¥",
        "transportation": "åœ°é“1å·çº¿å¤©å®‰é—¨ä¸œç«™",
        "booking_method": "å®˜æ–¹ç½‘ç«™å®åé¢„çº¦"
      }
    }
  }
}
```

---

## ğŸ–¼ï¸ å›¾ç‰‡èµ„æºç®¡ç†

### 1. å›¾ç‰‡å­˜å‚¨æ–¹å¼

#### A. Base64ç¼–ç SVGå ä½å›¾
```python
# media_service.py
def create_svg_placeholder(self, name: str, width: int = 800, height: int = 400) -> str:
    colors = {
        "æ•…å®«": "#FF6B6B",
        "å¤©å®‰é—¨": "#4ECDC4", 
        "å¤©å›": "#45B7D1",
        "é¢å’Œå›­": "#96CEB4",
        "é•¿åŸ": "#FECA57"
    }
    
    svg = f'''<svg width="{width}" height="{height}" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="{color}"/>
        <text x="50%" y="50%" font-family="Arial, sans-serif" font-size="32" 
              fill="white" text-anchor="middle" dy=".3em">{name}</text>
    </svg>'''
    
    encoded = base64.b64encode(svg.encode('utf-8')).decode('utf-8')
    return f"data:image/svg+xml;base64,{encoded}"
```

#### B. å¤–éƒ¨URLé“¾æ¥
```python
# ä½¿ç”¨Unsplashç­‰å¤–éƒ¨å›¾ç‰‡æœåŠ¡
"image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=800"
```

#### C. AIç”Ÿæˆå›¾ç‰‡ (Base64)
```python
# gemini_service.py - AIç”Ÿæˆçš„å›¾ç‰‡
buffered = BytesIO()
generated_image.save(buffered, format="PNG")
img_base64 = base64.b64encode(buffered.getvalue()).decode('utf-8')

return {
    "filepath": filepath,
    "filename": filename,
    "image_url": f"data:image/png;base64,{img_base64}",
    "base64": f"data:image/png;base64,{img_base64}"
}
```

#### D. Doroå½¢è±¡å›¾ç‰‡å­˜å‚¨
```python
# doro_service.py
class DoroService:
    def __init__(self):
        self.preset_dir = self.base_dir / "preset"    # é¢„è®¾Doroå›¾ç‰‡
        self.custom_dir = self.base_dir / "custom"    # ç”¨æˆ·è‡ªå®šä¹‰å›¾ç‰‡
        self.supported_formats = {'.png', '.jpg', '.jpeg', '.webp', '.gif'}
```

### 2. å›¾ç‰‡ä¼˜å…ˆçº§ç­–ç•¥

```python
# å›¾ç‰‡åŠ è½½ä¼˜å…ˆçº§
1. AIç”Ÿæˆçš„ä¸ªæ€§åŒ–å›¾ç‰‡ (æœ€é«˜ä¼˜å…ˆçº§)
2. å¤–éƒ¨URLå›¾ç‰‡ (Unsplashç­‰)
3. æœ¬åœ°é™æ€å›¾ç‰‡æ–‡ä»¶
4. Base64ç¼–ç çš„SVGå ä½å›¾ (å…œåº•æ–¹æ¡ˆ)
```

### 3. å›¾ç‰‡é”™è¯¯å¤„ç†

```javascript
// å‰ç«¯å›¾ç‰‡åŠ è½½é”™è¯¯å¤„ç†
<img src="${attraction.image}" alt="${attraction.name}" 
     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuaaguaXoOWbvueJhzwvdGV4dD48L3N2Zz4='"
```

---

## ğŸ”Œ æ•°æ®è·å–API

### 1. æ ¸å¿ƒAPIç«¯ç‚¹

#### A. æ¢ç´¢æ–¹å‘API
```python
@app.post("/api/explore-real", response_model=ExploreResponse)
async def explore_direction_real(request: ExploreRequest):
    """æ¢ç´¢æŒ‡å®šæ–¹å‘çš„åœ°ç‚¹ï¼ˆä½¿ç”¨çœŸå®æ•°æ®ï¼‰"""
    
    # æ•°æ®è·å–ä¼˜å…ˆçº§ï¼š
    # 1. æœ¬åœ°æ™¯ç‚¹æ•°æ®åº“ (local_attractions_db)
    # 2. å…¨çƒåŸå¸‚æ•°æ®åº“ (global_cities_db)
    # 3. é«˜å¾·åœ°å›¾API (amap_service) - å¤‡ç”¨
    
    places_data_list = local_attractions_db.find_nearby_attractions(
        target_lat, target_lon, radius_km=50
    )
    
    if len(places_data_list) == 0:
        places_data_list = global_cities_db.find_nearby_attractions(
            target_lat, target_lon, radius_km=50
        )
```

#### B. åŸå¸‚ç›¸å…³API
```python
# è·å–æ‰€æœ‰åŸå¸‚åˆ—è¡¨
@app.get("/api/cities", response_model=List[CityInfo])
async def get_all_cities():
    cities = global_cities_db.get_all_cities()
    return cities

# è·å–æŒ‡å®šåŸå¸‚çš„æ™¯ç‚¹
@app.get("/api/cities/{city_key}/attractions", response_model=List[AttractionInfo])
async def get_city_attractions(city_key: str):
    if city_key == "beijing":
        # ç‰¹æ®Šå¤„ç†åŒ—äº¬ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®åº“
        attractions = local_attractions_db.attractions
    else:
        # å…¶ä»–åŸå¸‚ä½¿ç”¨å…¨çƒæ•°æ®åº“
        attractions = global_cities_db.get_city_attractions(city_key)

# åŸå¸‚æ¼«æ¸¸API
@app.post("/api/cities/roam", response_model=CityRoamingResponse)
async def roam_to_city(request: CityRoamingRequest):
    city_info = global_cities_db.get_city_by_key(request.city_key)
    attraction_data = global_cities_db.get_random_attraction(request.city_key)
```

### 2. æ•°æ®æ¨¡å‹å®šä¹‰

#### A. æ™¯ç‚¹ä¿¡æ¯æ¨¡å‹
```python
class AttractionInfo(BaseModel):
    name: str
    latitude: float
    longitude: float
    category: str
    description: str
    opening_hours: str
    ticket_price: str
    booking_method: str
    image: Optional[str] = None
    video: Optional[str] = None
    country: str
    city: str
    address: str
```

#### B. åŸå¸‚ä¿¡æ¯æ¨¡å‹
```python
class CityInfo(BaseModel):
    key: str
    name: str
    country: str
    coordinates: List[float]
    attraction_count: int
```

#### C. æ¢ç´¢å“åº”æ¨¡å‹
```python
class ExploreResponse(BaseModel):
    places: List[PlaceInfo]
    total_distance: float
    calculation_time: float
    points: List[Dict]
    message: str
```

---

## ğŸŒ å‰ç«¯æ•°æ®å¤„ç†

### 1. æ•°æ®è·å–æµç¨‹

#### A. åŸå¸‚æ™¯ç‚¹åŠ è½½
```javascript
// è·å–åŸå¸‚æ™¯ç‚¹åˆ—è¡¨
async function showCityAttractions() {
    const response = await fetch(`${getAPIBaseURL()}/api/cities/${selectedCity.key}/attractions`);
    const attractions = await response.json();
    displayCityAttractions(selectedCity, attractions);
}
```

#### B. éšæœºæ¼«æ¸¸åŠŸèƒ½
```javascript
// éšæœºæ¼«æ¸¸åˆ°æ™¯ç‚¹
async function roamToRandomAttraction() {
    const response = await fetch(`${getAPIBaseURL()}/api/cities/roam`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({city_key: selectedCity.key})
    });
    const result = await response.json();
    showAttractionRoamingSuccess(result.attraction);
}
```

### 2. æ•°æ®å±•ç¤ºç»„ä»¶

#### A. æ™¯ç‚¹å¡ç‰‡åˆ›å»º
```javascript
function createAttractionCard(attraction, index) {
    const card = document.createElement('div');
    card.className = 'place-card attraction-card';
    
    card.innerHTML = `
        <div class="place-media">
            ${attraction.image ? `
                <img src="${attraction.image}" alt="${attraction.name}" class="place-image" 
                     onerror="this.src='[å ä½å›¾Base64]'"
            ` : `
                <div class="place-image-placeholder">
                    <span style="font-size: 3rem;">ğŸ“¸</span>
                    <p>æš‚æ— å›¾ç‰‡</p>
                </div>
            `}
        </div>
        <div class="place-content">
            <h3 class="place-name">${attraction.name}</h3>
            <div class="place-location-info">
                ğŸ“ ${attraction.latitude.toFixed(4)}Â°, ${attraction.longitude.toFixed(4)}Â°
                | ${attraction.country} - ${attraction.city}
            </div>
            <p class="place-description">${attraction.description}</p>
        </div>
    `;
    
    return card;
}
```

#### B. å†å²åœºæ™¯å±•ç¤º
```javascript
function displayHistoryScenes() {
    journeyManagement.historyScenes.forEach((scene, index) => {
        const historyCard = document.createElement('div');
        historyCard.innerHTML = `
            <img src="${scene.image || '[é»˜è®¤å ä½å›¾]'}" 
                 alt="${scene.name}" 
                 class="place-image"
                 onerror="this.src='[é”™è¯¯å ä½å›¾]'"
            <div class="place-content">
                <h3 class="place-name">${scene.name}</h3>
                <p class="place-description">${scene.description}</p>
                <div class="place-meta">
                    <span class="visit-time">ğŸ•’ ${scene.visitTime}</span>
                    <span class="place-coordinates">ğŸ“ ${scene.latitude.toFixed(4)}, ${scene.longitude.toFixed(4)}</span>
                </div>
            </div>
        `;
    });
}
```

---

## ğŸ”„ æ•°æ®ç¼“å­˜æœºåˆ¶

### 1. åç«¯ç¼“å­˜

#### A. åœ°ç†ç¼–ç ç¼“å­˜
```python
# main.py
geocode_cache = {}  # ç¼“å­˜åœ°ç†ç¼–ç ç»“æœ
cache_max_size = 1000  # æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
```

#### B. åª’ä½“æœåŠ¡ç¼“å­˜
```python
# real_data_service.py
class RealDataService:
    def __init__(self):
        self.cache = {}
        self.cache_file = 'data_cache.json'
        
    def load_cache(self):
        if os.path.exists(self.cache_file):
            with open(self.cache_file, 'r', encoding='utf-8') as f:
                self.cache = json.load(f)
```

#### C. Doroå½¢è±¡ç¼“å­˜
```python
# doro_service.py
class DoroService:
    def __init__(self):
        self._doro_cache = {}  # Doroå…ƒæ•°æ®ç¼“å­˜
```

### 2. å‰ç«¯ç¼“å­˜

#### A. æµè§ˆå™¨æœ¬åœ°å­˜å‚¨
```javascript
// ç¯å¢ƒé…ç½®ç¼“å­˜
localStorage.setItem('isUsedomainnameaddress', useDomain.toString());

// ç”¨æˆ·åå¥½ç¼“å­˜
localStorage.setItem('selectedLanguage', languageCode);
```

#### B. å†…å­˜ç¼“å­˜
```javascript
// å…¨å±€æ•°æ®ç¼“å­˜
let sceneManagement = {
    allScenes: [],           // æ‰€æœ‰åœºæ™¯æ•°æ®
    currentSceneIndex: 0,    // å½“å‰åœºæ™¯ç´¢å¼•
    historyScenes: []        // å†å²è®¿é—®åœºæ™¯
};
```

---

## ğŸ“± ç§»åŠ¨ç«¯é€‚é…

### 1. å“åº”å¼å›¾ç‰‡å¤„ç†

```css
/* styles.css - ç§»åŠ¨ç«¯å›¾ç‰‡é€‚é… */
.place-image {
    width: 100%;
    max-width: 100%;
    height: auto;
    max-height: 400px;
    object-fit: contain;
    border-radius: 12px;
}

@media (max-width: 768px) {
    .place-image {
        max-height: 250px;
    }
}
```

### 2. è§¦æ‘¸äº¤äº’ä¼˜åŒ–

```javascript
// ç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶å¤„ç†
card.addEventListener('touchstart', function(e) {
    // è§¦æ‘¸å¼€å§‹å¤„ç†
});

card.addEventListener('touchend', function(e) {
    // è§¦æ‘¸ç»“æŸå¤„ç†
});
```

---

## ğŸ”§ é…ç½®ç®¡ç†

### 1. ç¯å¢ƒé…ç½®

#### A. æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
# ç¯å¢ƒå˜é‡
export isUsedomainnameaddress=false
API_BASE_URL=http://localhost:8001
```

#### B. ç”Ÿäº§ç¯å¢ƒ
```bash
# ç¯å¢ƒå˜é‡
export isUsedomainnameaddress=true
API_BASE_URL=https://spot.gitagent.io
```

### 2. APIå¯†é’¥ç®¡ç†

```python
# .envæ–‡ä»¶é…ç½®
GEMINI_API_KEY=your_gemini_api_key
OPENWEATHER_API_KEY=your_openweather_api_key
UNSPLASH_API_KEY=your_unsplash_api_key
AMAP_API_KEY=your_amap_api_key
SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_ROLE_KEY=your_supabase_key
SUPABASE_JWT_SECRET=your_jwt_secret
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å›¾ç‰‡åŠ è½½ä¼˜åŒ–

#### A. æ‡’åŠ è½½å®ç°
```javascript
// å›¾ç‰‡æ‡’åŠ è½½
const imageObserver = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove('lazy');
            observer.unobserve(img);
        }
    });
});
```

#### B. å›¾ç‰‡å‹ç¼©
```python
# å›¾ç‰‡å‹ç¼©å¤„ç†
def compress_image(image_path, quality=85):
    with Image.open(image_path) as img:
        img.save(image_path, optimize=True, quality=quality)
```

### 2. æ•°æ®é¢„åŠ è½½

```javascript
// é¢„åŠ è½½å…³é”®æ•°æ®
async function preloadCriticalData() {
    // é¢„åŠ è½½åŸå¸‚åˆ—è¡¨
    const cities = await fetch(`${getAPIBaseURL()}/api/cities`);
    
    // é¢„åŠ è½½å½“å‰åŸå¸‚æ™¯ç‚¹
    if (currentCity) {
        const attractions = await fetch(`${getAPIBaseURL()}/api/cities/${currentCity}/attractions`);
    }
}
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### 1. å¸¸è§é—®é¢˜

#### A. å›¾ç‰‡åŠ è½½å¤±è´¥
**ç—‡çŠ¶**: å›¾ç‰‡æ˜¾ç¤ºä¸ºå ä½å›¾æˆ–ç©ºç™½
**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥å›¾ç‰‡URLæ˜¯å¦æœ‰æ•ˆ
2. éªŒè¯ç½‘ç»œè¿æ¥
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
4. æ£€æŸ¥CORSè®¾ç½®

#### B. æ•°æ®è·å–å¤±è´¥
**ç—‡çŠ¶**: æ™¯ç‚¹åˆ—è¡¨ä¸ºç©ºæˆ–åŠ è½½å¤±è´¥
**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥APIç«¯ç‚¹æ˜¯å¦æ­£å¸¸
2. éªŒè¯æ•°æ®åº“è¿æ¥
3. æŸ¥çœ‹åç«¯æ—¥å¿—
4. æ£€æŸ¥ç¯å¢ƒé…ç½®

#### C. ç¼“å­˜é—®é¢˜
**ç—‡çŠ¶**: æ•°æ®æ›´æ–°ä¸åŠæ—¶
**è§£å†³æ–¹æ¡ˆ**:
```javascript
// æ¸…é™¤ç¼“å­˜
localStorage.clear();
// æˆ–å¼ºåˆ¶åˆ·æ–°
location.reload(true);
```

### 2. è°ƒè¯•å·¥å…·

#### A. åç«¯è°ƒè¯•
```python
# å¯ç”¨è¯¦ç»†æ—¥å¿—
import logging
logging.basicConfig(level=logging.DEBUG)

# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
logger.info(f"æœ¬åœ°æ•°æ®åº“æ™¯ç‚¹æ•°é‡: {len(local_attractions_db.attractions)}")
logger.info(f"å…¨çƒæ•°æ®åº“åŸå¸‚æ•°é‡: {len(global_cities_db.global_cities)}")
```

#### B. å‰ç«¯è°ƒè¯•
```javascript
// æµè§ˆå™¨æ§åˆ¶å°è°ƒè¯•
console.log('å½“å‰APIåŸºç¡€URL:', getAPIBaseURL());
console.log('åœºæ™¯ç®¡ç†çŠ¶æ€:', sceneManagement);
console.log('é€‰ä¸­åŸå¸‚:', selectedCity);
```

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡

### 1. å½“å‰æ•°æ®è§„æ¨¡

| æ•°æ®ç±»å‹ | æ•°é‡ | è¯´æ˜ |
|---------|------|------|
| å…¨çƒåŸå¸‚ | 25+ | è¦†ç›–ä¸»è¦æ—…æ¸¸åŸå¸‚ |
| åŒ—äº¬æ™¯ç‚¹ | 22 | ç²¾é€‰ä»£è¡¨æ€§æ™¯ç‚¹ |
| å…¨çƒæ™¯ç‚¹ | 200+ | å„åŸå¸‚çŸ¥åæ™¯ç‚¹ |
| é¢„è®¾Doro | 10+ | é¢„è®¾å½¢è±¡å›¾ç‰‡ |
| å›¾ç‰‡èµ„æº | 1000+ | åŒ…å«URLå’ŒBase64 |

### 2. APIè°ƒç”¨ç»Ÿè®¡

```python
# ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°çš„å…¸å‹è°ƒç”¨
INFO: 127.0.0.1:54861 - "GET /api/cities/beijing/attractions HTTP/1.1" 200 OK
INFO: 127.0.0.1:54901 - "POST /api/explore-real HTTP/1.1" 200 OK
INFO: ä»æœ¬åœ°æ•°æ®åº“ä¸­æ‰¾åˆ° 22 ä¸ªæ™¯ç‚¹ï¼Œè·ç¦»ç›®æ ‡ç‚¹ (40.0064, 116.3972) 50km ä»¥å†…
```

---

## ğŸ”® æœªæ¥æ‰©å±•

### 1. æ•°æ®æ‰©å±•è®¡åˆ’

- **æ›´å¤šåŸå¸‚**: æ‰©å±•åˆ°100+å…¨çƒåŸå¸‚
- **å®æ—¶æ•°æ®**: é›†æˆå®æ—¶å¤©æ°”ã€äº¤é€šä¿¡æ¯
- **ç”¨æˆ·ç”Ÿæˆå†…å®¹**: æ”¯æŒç”¨æˆ·ä¸Šä¼ æ™¯ç‚¹å›¾ç‰‡å’Œè¯„ä»·
- **å¤šåª’ä½“æ”¯æŒ**: å¢åŠ éŸ³é¢‘å¯¼è§ˆã€VRå…¨æ™¯

### 2. æŠ€æœ¯ä¼˜åŒ–

- **CDNé›†æˆ**: å›¾ç‰‡èµ„æºCDNåŠ é€Ÿ
- **æ•°æ®åº“ä¼˜åŒ–**: ä½¿ç”¨ä¸“ä¸šæ•°æ®åº“æ›¿ä»£JSONæ–‡ä»¶
- **AIå¢å¼º**: æ›´æ™ºèƒ½çš„æ™¯ç‚¹æ¨èç®—æ³•
- **ç¦»çº¿æ”¯æŒ**: å…³é”®æ•°æ®ç¦»çº¿ç¼“å­˜

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨æ–¹æ¡ˆ.md](./æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨æ–¹æ¡ˆ.md) - æœ¬åœ°å¼€å‘é…ç½®
- [0904æœ¬åœ°å¼€å‘åŠæœåŠ¡å™¨éƒ¨ç½²çŠ¶æ€å˜é‡.md](./0904æœ¬åœ°å¼€å‘åŠæœåŠ¡å™¨éƒ¨ç½²çŠ¶æ€å˜é‡.md) - ç¯å¢ƒé…ç½®è¯¦æƒ…
- [0905å›¾ç‰‡å‚æ•°é—®é¢˜æ”¹è¿›.md](./0905å›¾ç‰‡å‚æ•°é—®é¢˜æ”¹è¿›.md) - å›¾ç‰‡å¤„ç†æŠ€æœ¯æ–¹æ¡ˆ

---

## ğŸ“ æ€»ç»“

OrientDirectorçš„åœ°å›¾å¯¼èˆªç›¸å†Œç³»ç»Ÿé‡‡ç”¨äº†å¤šå±‚æ¬¡çš„æ•°æ®å­˜å‚¨æ¶æ„ï¼š

### âœ… **æ ¸å¿ƒç‰¹æ€§**
1. **å¤šæ•°æ®æº**: æœ¬åœ°æ•°æ®åº“ + å…¨çƒæ•°æ®åº“ + å¤–éƒ¨API
2. **çµæ´»å›¾ç‰‡ç®¡ç†**: Base64 SVG + URLé“¾æ¥ + AIç”Ÿæˆ
3. **æ™ºèƒ½ç¼“å­˜**: å¤šçº§ç¼“å­˜æå‡æ€§èƒ½
4. **å“åº”å¼è®¾è®¡**: é€‚é…å„ç§è®¾å¤‡
5. **å®¹é”™æœºåˆ¶**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œå…œåº•æ–¹æ¡ˆ

### ğŸ¯ **æŠ€æœ¯äº®ç‚¹**
- **æ•°æ®è·å–ä¼˜å…ˆçº§ç­–ç•¥**: ç¡®ä¿æ•°æ®å¯ç”¨æ€§
- **å›¾ç‰‡åŠ è½½å®¹é”™æœºåˆ¶**: å¤šé‡å¤‡é€‰æ–¹æ¡ˆ
- **å‰åç«¯æ•°æ®åŒæ­¥**: å®æ—¶æ›´æ–°å’Œç¼“å­˜ç®¡ç†
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**: å“åº”å¼å¸ƒå±€å’Œè§¦æ‘¸äº¤äº’

### ğŸš€ **è¿è¡ŒçŠ¶æ€**
- **åç«¯æœåŠ¡**: æ­£å¸¸è¿è¡Œï¼ŒAPIå“åº”ç¨³å®š
- **æ•°æ®å®Œæ•´æ€§**: 22ä¸ªåŒ—äº¬æ™¯ç‚¹ + 25+å…¨çƒåŸå¸‚
- **å›¾ç‰‡èµ„æº**: å¤šç§æ ¼å¼æ”¯æŒï¼ŒåŠ è½½æˆåŠŸç‡é«˜
- **ç”¨æˆ·ä½“éªŒ**: æµç•…çš„å¯¼èˆªå’Œç›¸å†Œæµè§ˆ

è¯¥ç³»ç»Ÿä¸ºç”¨æˆ·æä¾›äº†ä¸°å¯Œçš„åœ°å›¾å¯¼èˆªå’Œæ™¯ç‚¹ç›¸å†ŒåŠŸèƒ½ï¼Œæ”¯æŒå…¨çƒåŸå¸‚æ¢ç´¢å’Œä¸ªæ€§åŒ–çš„æ—…è¡Œä½“éªŒã€‚

**æœ€åæ›´æ–°**: 2025å¹´9æœˆ8æ—¥  
**æŠ€æœ¯æ”¯æŒ**: Claude Sonnet 4 AI Assistant  
**é¡¹ç›®åœ°å€**: https://spot.gitagent.io
