<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>spot.gitagent.io - Discover your next spot!</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles_doro.css">
    <!-- Supabaseå®¢æˆ·ç«¯ -->
    <script src="./supabase-client.js"></script>
    <style>
        /* æŒ‡å—é’ˆLogoæ ·å¼ */
        .compass-logo {
            display: inline-block;
            width: 32px;
            height: 32px;
            border: 3px solid #333;
            border-radius: 50%;
            position: relative;
            margin-right: 12px;
            vertical-align: middle;
            background: white;
        }
        
        .compass-logo::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 12px solid #1976d2;
            transform: translate(-50%, -50%);
        }
        
        .compass-logo::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 12px solid #d32f2f;
            transform: translate(-50%, -50%);
        }
        
        .compass-logo .north {
            position: absolute;
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: bold;
            color: #333;
        }
        
        .compass-logo .east {
            position: absolute;
            right: 2px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            font-weight: bold;
            color: #333;
        }
        
        .compass-logo .south {
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: bold;
            color: #333;
        }
        
        .compass-logo .west {
            position: absolute;
            left: 2px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            font-weight: bold;
            color: #333;
        }
        
        .app-title-text {
            vertical-align: middle;
        }
    </style>
    
    <!-- å…³é”®å‡½æ•°å®šä¹‰ - ç¡®ä¿åœ¨HTMLè§£æå‰å°±å¯ç”¨ -->
    <script>
        // å…¨å±€å‡½æ•°å®šä¹‰ - ç«‹å³å¯ç”¨
        function toggleLanguageDropdown() {
            console.log('toggleLanguageDropdown è¢«è°ƒç”¨');
            const dropdown = document.getElementById('language-dropdown');
            if (dropdown) {
                dropdown.classList.toggle('hidden');
                console.log('è¯­è¨€ä¸‹æ‹‰èœå•åˆ‡æ¢æˆåŠŸ');
            } else {
                console.error('æ‰¾ä¸åˆ° language-dropdown å…ƒç´ ');
            }
        }

        function toggleUserMenu() {
            console.log('toggleUserMenu è¢«è°ƒç”¨');
            const dropdown = document.getElementById('user-dropdown');
            if (dropdown) {
                dropdown.classList.toggle('hidden');
                console.log('ç”¨æˆ·èœå•åˆ‡æ¢æˆåŠŸ');
            } else {
                console.error('æ‰¾ä¸åˆ° user-dropdown å…ƒç´ ');
            }
        }

        function toggleSettings() {
            console.log('toggleSettings è¢«è°ƒç”¨');
            const panel = document.getElementById('settingsPanel');
            if (panel) {
                panel.classList.toggle('active');
                console.log('è®¾ç½®é¢æ¿åˆ‡æ¢æˆåŠŸ');
            } else {
                console.error('æ‰¾ä¸åˆ° settingsPanel å…ƒç´ ');
            }
        }

        // æ£€æŸ¥ç™»å½•çŠ¶æ€çš„å‡½æ•°
        function checkLoginStatus() {
            const token = localStorage.getItem('access_token');
            return !!token;
        }

        // éœ€è¦ç™»å½•çš„åŠŸèƒ½æ£€æŸ¥
        function requireLogin(callback, ...args) {
            if (checkLoginStatus()) {
                // å·²ç™»å½•ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°
                callback.apply(this, args);
            } else {
                // æœªç™»å½•ï¼Œæ‰“å¼€æ–°çª—å£è¿›è¡Œç™»å½•
                const loginUrl = window.location.origin + '/login.html';
                const loginWindow = window.open(loginUrl, 'login', 'width=500,height=700,scrollbars=yes,resizable=yes,centerscreen=yes');
                
                // ç›‘å¬æ¥è‡ªç™»å½•çª—å£çš„æ¶ˆæ¯
                const messageHandler = (event) => {
                    if (event.origin !== window.location.origin) return;
                    
                    if (event.data.type === 'login-success') {
                        console.log('ç™»å½•æˆåŠŸï¼Œæ‰§è¡ŒåŸå§‹æ“ä½œ');
                        window.removeEventListener('message', messageHandler);
                        
                        // æ›´æ–°ç”¨æˆ·ç•Œé¢
                        checkAuthStatus();
                        
                        // æ‰§è¡ŒåŸå§‹æ“ä½œ
                        setTimeout(() => {
                            callback.apply(this, args);
                        }, 500);
                    }
                };
                
                window.addEventListener('message', messageHandler);
                
                // ç›‘å¬çª—å£å…³é—­äº‹ä»¶
                const checkClosed = setInterval(() => {
                    if (loginWindow.closed) {
                        clearInterval(checkClosed);
                        window.removeEventListener('message', messageHandler);
                        
                        // æ£€æŸ¥æ˜¯å¦ç™»å½•æˆåŠŸï¼ˆå¤‡ç”¨æ£€æŸ¥ï¼‰
                        if (checkLoginStatus()) {
                            console.log('æ£€æµ‹åˆ°ç™»å½•çŠ¶æ€ï¼Œæ‰§è¡ŒåŸå§‹æ“ä½œ');
                            checkAuthStatus();
                            callback.apply(this, args);
                        }
                    }
                }, 1000);
                
                console.log('ç”¨æˆ·æœªç™»å½•ï¼Œå·²æ‰“å¼€ç™»å½•çª—å£');
            }
        }
        
        console.log('âœ… å…³é”®å‡½æ•°å·²åœ¨å¤´éƒ¨å®šä¹‰');
    </script>
</head>
<body>
    <div class="app-container">
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <header class="header">
            <div class="header-left">
                <h1 id="app-title">
                    <span class="compass-logo"></span>
                    <span class="app-title-text">spot.gitagent.io</span>
                </h1>
                <span id="app-subtitle" class="subtitle">Discover your next spot!</span>
            </div>
            <div class="header-right">
                <!-- è¯­è¨€é€‰æ‹©å™¨ -->
                <div class="language-selector">
                    <button class="language-button" onclick="toggleLanguageDropdown()">
                        <span id="current-flag">ğŸ‡¨ğŸ‡³</span>
                        <span id="current-lang">ä¸­æ–‡</span>
                    </button>
                    <div class="language-dropdown hidden" id="language-dropdown">
                        <!-- è¯­è¨€é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <!-- ç”¨æˆ·èœå• -->
                <div class="user-menu" id="user-menu">
                    <button class="user-button" onclick="toggleUserMenu()">
                        <span id="user-avatar">ğŸ‘¤</span>
                        <span id="user-name">æ¸¸å®¢</span>
                    </button>
                    <div class="user-dropdown hidden" id="user-dropdown">
                        <div class="user-info">
                            <div id="user-email">æœªç™»å½•</div>
                        </div>
                        <div class="user-actions">
                            <button onclick="showAuthModal('login')" id="login-btn">ç™»å½•</button>
                            <button onclick="showAuthModal('register')" id="register-btn">æ³¨å†Œ</button>
                            <button onclick="logout()" id="logout-btn" class="hidden">é€€å‡ºç™»å½•</button>
                        </div>
                    </div>
                </div>
                
                <button class="settings-btn" onclick="toggleSettings()">âš™ï¸</button>
            </div>
        </header>

        <!-- è®¾ç½®é¢æ¿ -->
        <div class="settings-panel" id="settingsPanel">
            <div class="setting-group">
                <label>ç›®æ ‡è·ç¦»:</label>
                <select id="segmentDistance" onchange="updateSettings()">
                    <option value="5">5km</option>
                    <option value="10" selected>10km</option>
                    <option value="15">15km</option>
                    <option value="20">20km</option>
                </select>
            </div>
            <div class="setting-group">
                <label>æ¨¡å¼:</label>
                <select id="timeMode" onchange="updateSettings()">
                    <option value="present" selected>ç°ä»£æ¨¡å¼</option>
                    <option value="past">å¤ä»£æ¨¡å¼</option>
                </select>
            </div>

            <div class="setting-group">
                <label>é€Ÿåº¦ (km/h):</label>
                <input type="number" id="speed" value="120" min="1" max="1000" onchange="updateSettings()">
            </div>

            <!-- åŸå¸‚æ¼«æ¸¸åŠŸèƒ½ -->
            <div class="setting-group roaming-section">
                <label class="roaming-title" id="cityRoamingTitle">ğŸŒ åŸå¸‚æ¼«æ¸¸:</label>
                
                <!-- åŸå¸‚é€‰æ‹©å™¨ -->
                <div class="city-selector">
                    <div class="input-row">
                        <label id="selectCityLabel">é€‰æ‹©åŸå¸‚:</label>
                        <select id="citySelector" class="city-select" onchange="onCitySelected()">
                            <option value="" id="pleaseSelectCityOption">-- è¯·é€‰æ‹©åŸå¸‚ --</option>
                            <optgroup label="ğŸŒ å…¨çƒçŸ¥ååŸå¸‚" id="globalCitiesGroup">
                                <!-- å…¨çƒåŸå¸‚é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </optgroup>
                            <optgroup label="ğŸ‡¨ğŸ‡³ ä¸­å›½çŸ¥ååŸå¸‚" id="chinaCitiesGroup">
                                <!-- ä¸­å›½åŸå¸‚é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </optgroup>
                        </select>
                    </div>
                    
                    <!-- åŸå¸‚æœç´¢ -->
                    <div class="input-row">
                        <label id="searchCityLabel">æœç´¢åŸå¸‚:</label>
                        <input type="text" id="citySearch" placeholder="è¾“å…¥åŸå¸‚åç§°æœç´¢..." class="roaming-input" 
                               oninput="searchCities()" onkeypress="handleSearchEnter(event)">
                    </div>
                    
                    <!-- æœç´¢ç»“æœ -->
                    <div class="search-results" id="searchResults" style="display: none;"></div>
                    
                    <!-- é€‰ä¸­çš„åŸå¸‚ä¿¡æ¯ -->
                    <div class="selected-city-info" id="selectedCityInfo" style="display: none;">
                        <div class="city-info-card">
                            <h4 id="selectedCityName"></h4>
                            <p id="selectedCityDetails"></p>
                            <div class="city-actions">
                                <button class="action-btn" onclick="showCityAttractions()" id="viewAttractionsBtn">ğŸ›ï¸ <span id="viewAttractionsText">æŸ¥çœ‹æ™¯ç‚¹</span></button>
                                <button class="action-btn primary" onclick="roamToRandomAttraction()" id="randomRoamingBtn">ğŸ² <span id="randomRoamingText">éšæœºæ¼«æ¸¸</span></button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="roaming-status" id="roamingStatus" style="display: none;">
                    <div class="loading-spinner"></div>
                    <span id="roamingStatusText">æ­£åœ¨åŠ è½½åŸå¸‚ä¿¡æ¯...</span>
                </div>
            </div>
        </div>

        <!-- çŠ¶æ€æ˜¾ç¤ºåŒº -->
        <div class="status-section">
            <div class="location-info">
                <div class="current-location">
                    <span class="label" id="currentLocationLabel">å½“å‰ä½ç½®:</span>
                    <span id="currentLocation">è·å–ä¸­...</span>
                </div>
                <div class="coordinates-info">
                    <span class="label" id="coordinatesLabel">ç»çº¬åº¦:</span>
                    <span id="coordinates">--Â°, --Â°</span>
                </div>
                <div class="accuracy-info">
                    <span class="label" id="accuracyLabel">ç²¾åº¦:</span>
                    <span id="accuracy">--m</span>
                </div>
                <div class="compass-info">
                    <span class="label" id="compassDirectionLabel">æœå‘:</span>
                    <span id="compassDirection">--Â°</span>
                </div>
                <div class="direction-text">
                    <span class="label" id="directionTextLabel">æ–¹å‘:</span>
                    <span id="directionText">--</span>
                </div>
            </div>
            
            <!-- æŒ‡å—é’ˆæ˜¾ç¤º -->
            <div class="compass-container">
                <div class="compass" id="compass">
                    <div class="compass-needle" id="compassNeedle">
                        <div class="needle-diamond">
                            <div class="needle-north"></div>
                            <div class="needle-south"></div>
                        </div>
                    </div>
                    <div class="compass-center"></div>
                    <div class="compass-directions">
                        <div class="direction north">N</div>
                        <div class="direction east">E</div>
                        <div class="direction south">S</div>
                        <div class="direction west">W</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="controls">
            <button class="explore-btn" id="exploreBtn" onclick="startExploration()">
                ğŸš€ <span id="startExplorationText">å¼€å§‹æ¢ç´¢</span>
            </button>
            <button class="refresh-btn" onclick="refreshLocation()">
                ğŸ“ <span id="refreshLocationText">åˆ·æ–°ä½ç½®</span>
            </button>
            <button class="end-journey-btn" id="endJourneyBtn" onclick="endJourney()" style="display: none;">
                ğŸ  <span id="endJourneyText">ç»“æŸæ—…ç¨‹</span>
            </button>
        </div>

        <!-- å†å²è®¿é—®åœºæ™¯ -->
        <div class="journey-history-section" id="journeyHistorySection" style="display: none;">
            <h3>ğŸ’ <span id="visitedPlacesText">å·²è®¿é—®çš„åœ°ç‚¹</span></h3>
            <div class="history-places-container" id="historyPlacesContainer">
                <!-- å†å²è®¿é—®çš„åœ°ç‚¹å¡ç‰‡å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>

        <!-- åœ°ç‚¹å¡ç‰‡å®¹å™¨ -->
        <div class="places-container" id="placesContainer">
            <!-- åœ°ç‚¹å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
        <div class="loading" id="loading" style="display: none;">
            <div class="spinner"></div>
            <p>æ­£åœ¨è®¡ç®—è·¯å¾„...</p>
        </div>

        <!-- æ—¥å¿—æ˜¾ç¤ºåŒº -->
        <div class="log-section">
            <div class="log-header">
                <h3 id="systemLogText">ç³»ç»Ÿæ—¥å¿—</h3>
                <button class="clear-log-btn" onclick="clearLogs()" id="clearLogsBtn">æ¸…ç©ºæ—¥å¿—</button>
            </div>
            <div class="log-container" id="logContainer">
                <!-- æ—¥å¿—ä¿¡æ¯å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>

        <!-- Googleè¡—æ™¯æ¨¡æ€æ¡† -->
        <div class="streetview-modal" id="streetviewModal" style="display: none;">
            <div class="streetview-modal-content">
                <div class="streetview-header">
                    <h3 id="streetviewTitle">ğŸ™ï¸ è¡—æ™¯è§†å›¾</h3>
                    <button class="close-streetview-btn" onclick="closeStreetView()">âœ•</button>
                </div>
                <div class="streetview-controls">
                    <button class="streetview-control-btn" onclick="resetStreetViewHeading()" title="é‡ç½®æœå‘">
                        ğŸ§­ é‡ç½®è§†è§’
                    </button>
                    <button class="streetview-control-btn" onclick="toggleStreetViewFullscreen()" title="å…¨å±">
                        ğŸ” å…¨å±
                    </button>
                    <button class="streetview-control-btn" onclick="shareStreetView()" title="åˆ†äº«ä½ç½®">
                        ğŸ“¤ åˆ†äº«
                    </button>
                </div>
                <div class="streetview-container" id="streetviewContainer">
                    <div class="streetview-loading" id="streetviewLoading">
                        <div class="streetview-spinner"></div>
                        <p>æ­£åœ¨åŠ è½½è¡—æ™¯...</p>
                    </div>
                    <div class="streetview-error" id="streetviewError" style="display: none;">
                        <div class="error-icon">ğŸš«</div>
                        <h4>è¡—æ™¯ä¸å¯ç”¨</h4>
                        <p id="streetviewErrorText">è¯¥ä½ç½®æš‚æ—¶æ²¡æœ‰è¡—æ™¯æ•°æ®</p>
                        <button class="retry-streetview-btn" onclick="retryStreetView()">é‡è¯•</button>
                    </div>
                </div>
                <div class="streetview-info" id="streetviewInfo">
                    <div class="streetview-location">
                        <span class="info-label">ğŸ“ ä½ç½®:</span>
                        <span id="streetviewLocation">--</span>
                    </div>
                    <div class="streetview-coordinates">
                        <span class="info-label">ğŸ“Š åæ ‡:</span>
                        <span id="streetviewCoords">--</span>
                    </div>
                    <div class="streetview-date">
                        <span class="info-label">ğŸ“… æ‹æ‘„æ—¶é—´:</span>
                        <span id="streetviewDate">--</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Googleè¡—æ™¯é®ç½©å±‚ -->
        <div class="streetview-overlay" id="streetviewOverlay" style="display: none;" onclick="closeStreetView()"></div>
        
        <!-- æ™¯ç‚¹åˆå½±ç”Ÿæˆæ¨¡æ€æ¡† -->
        <div class="selfie-modal" id="selfieModal" style="display: none;">
            <div class="selfie-modal-content">
                <button class="selfie-close-btn" onclick="closeSelfieModal()" title="å…³é—­">
                    âœ•
                </button>
                <div class="selfie-header">
                    <h3>ğŸ“¸ ç”Ÿæˆæ™¯ç‚¹åˆå½±</h3>
                </div>
                
                <div class="selfie-body">
                    <div class="selfie-info">
                        <h4 id="selfieAttractionName">æ™¯ç‚¹åç§°</h4>
                        <p id="selfieAttractionLocation">ä½ç½®ä¿¡æ¯</p>
                    </div>
                    
                    <div class="selfie-upload-section" id="selfieUploadSection">
                        <div class="upload-section">
                            <div class="upload-group">
                                <h4>ğŸ“· æ‚¨çš„ç…§ç‰‡</h4>
                                <div class="upload-area" id="uploadArea" onclick="document.getElementById('selfiePhotoInput').click()">
                                    <input type="file" id="selfiePhotoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                                    <div class="upload-placeholder" id="uploadPlaceholder">
                                        <div class="upload-icon">ğŸ“·</div>
                                        <p>ç‚¹å‡»ä¸Šä¼ æ‚¨çš„ç…§ç‰‡</p>
                                        <p class="upload-hint">æ”¯æŒ JPGã€PNG æ ¼å¼</p>
                                    </div>
                                    <img id="uploadPreview" class="upload-preview" style="display: none;" alt="é¢„è§ˆå›¾">
                                </div>
                            </div>
                            
                            <div class="upload-group">
                                <h4>ğŸ¨ èŒƒä¾‹é£æ ¼å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰</h4>
                                <div class="upload-area" id="styleUploadArea" onclick="document.getElementById('stylePhotoInput').click()">
                                    <input type="file" id="stylePhotoInput" accept="image/*" style="display: none;" onchange="handleStylePhotoUpload(event)">
                                    <div class="upload-placeholder" id="stylePlaceholder">
                                        <div class="upload-icon">ğŸ¨</div>
                                        <p>ç‚¹å‡»ä¸Šä¼ èŒƒä¾‹é£æ ¼å›¾ç‰‡</p>
                                        <p class="upload-hint">ç”¨äºæ¨¡ä»¿æœè£…æˆ–é£æ ¼</p>
                                    </div>
                                    <img id="stylePreview" class="upload-preview" style="display: none;" alt="é£æ ¼é¢„è§ˆå›¾">
                                </div>
                            </div>
                        </div>
                        
                        <div class="prompt-section">
                            <label for="customPrompt">è‡ªå®šä¹‰æç¤ºè¯ï¼ˆå¯é€‰ï¼‰ï¼š</label>
                            <textarea id="customPrompt" rows="3" placeholder="è¾“å…¥é¢å¤–è¦æ±‚ï¼Œå°†è¿½åŠ åˆ°åŸºç¡€æç¤ºè¯åé¢ã€‚ä¾‹å¦‚ï¼šæŒ‰ç¬¬äºŒä¸ªæ©™è‰²é«˜å­ç”·ç”Ÿï¼Œæ¢ä»–çš„è¡£æœå’Œè£¤å­æœè£…ï¼Œå¤´åƒæ›´æ¢æˆå½“å‰ä¸»äººçš„å¤´åƒï¼Œåªä¿ç•™ä¸€ä¸ªäºº"></textarea>
                        </div>
                        
                        <div class="selfie-actions">
                            <button class="generate-btn" id="generateBtn" onclick="generateSelfie()" disabled>
                                âœ¨ ç”Ÿæˆåˆå½±
                            </button>
                            <button class="cancel-btn" onclick="closeSelfieModal()">
                                âŒ å–æ¶ˆ
                            </button>
                        </div>
                    </div>
                    
                    <div class="selfie-loading" id="selfieLoading" style="display: none;">
                        <div class="loading-content">
                            <div class="selfie-spinner"></div>
                            <h4 class="loading-title">æ­£åœ¨ç”Ÿæˆæ‚¨çš„æ™¯ç‚¹åˆå½±...</h4>
                            <p class="loading-hint">è¿™å¯èƒ½éœ€è¦ 10-30 ç§’ï¼Œè¯·è€å¿ƒç­‰å¾… â°</p>
                        </div>
                    </div>
                    
                    <div class="selfie-result" id="selfieResult" style="display: none;">
                        <div class="generated-image-container">
                            <img id="generatedSelfie" class="generated-selfie" alt="ç”Ÿæˆçš„åˆå½±" onclick="showImageModal(this.src)">
                            <div class="image-hint">ç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾</div>
                        </div>
                        <div class="result-actions">
                            <button class="download-btn" onclick="downloadSelfie()">
                                ğŸ’¾ ä¸‹è½½åˆå½±
                            </button>
                            <button class="regenerate-btn" onclick="regenerateWithCurrentStyle()">
                                ğŸ”„ å½“å‰é£æ ¼é‡æ–°ç”Ÿæˆ
                            </button>
                            <button class="share-btn" onclick="shareSelfie()">
                                ğŸ“¤ åˆ†äº«åˆå½±
                            </button>
                        </div>
                    </div>
                    
                    <div class="selfie-error" id="selfieError" style="display: none;">
                        <div class="error-icon">âŒ</div>
                        <h4>ç”Ÿæˆå¤±è´¥</h4>
                        <p id="selfieErrorMessage">ç”Ÿæˆåˆå½±æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•</p>
                        <button class="retry-btn" onclick="resetSelfieGenerator()">é‡è¯•</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åˆå½±ç”Ÿæˆé®ç½©å±‚ -->
        <div class="selfie-overlay" id="selfieOverlay" style="display: none;"></div>
        
        <!-- Doroåˆå½±ç”Ÿæˆæ¨¡æ€æ¡† -->
        <div class="doro-selfie-modal" id="doroSelfieModal" style="display: none;">
            <div class="doro-modal-content">
                <button class="doro-close-btn" onclick="closeDoroModal()" title="å…³é—­">
                    âœ•
                </button>
                <div class="doro-header">
                    <h3>ğŸ¤ Doroä¸æˆ‘åˆå½±</h3>
                    <p class="doro-subtitle">åˆ›å»ºæ‚¨ä¸è™šæ‹Ÿä¼™ä¼´Doroçš„ç²¾å½©åˆå½±</p>
                </div>
                
                <div class="doro-body">
                    <div class="doro-info">
                        <h4 id="doroAttractionName">æ™¯ç‚¹åç§°</h4>
                        <p id="doroAttractionLocation">ä½ç½®ä¿¡æ¯</p>
                    </div>
                    
                    <!-- ä¸Šä¼ åŒºåŸŸ -->
                    <div class="upload-section">
                        <div class="upload-group">
                            <h4>ğŸ“· æ‚¨çš„ç…§ç‰‡</h4>
                            <div class="upload-area" id="userPhotoArea" onclick="document.getElementById('doroUserPhotoInput').click()">
                                <input type="file" id="doroUserPhotoInput" accept="image/*" style="display: none;" onchange="handleDoroUserPhoto(event)">
                                <div class="upload-placeholder" id="userPhotoPlaceholder">
                                    <div class="upload-icon">ğŸ“·</div>
                                    <p>ç‚¹å‡»ä¸Šä¼ æ‚¨çš„ç…§ç‰‡</p>
                                    <p class="upload-hint">æ”¯æŒ JPGã€PNGã€WEBP æ ¼å¼</p>
                                </div>
                                <img id="userPhotoPreview" class="upload-preview" style="display: none;" alt="æ‚¨çš„ç…§ç‰‡">
                            </div>
                        </div>
                        
                        <div class="upload-group">
                            <h4>ğŸ­ é€‰æ‹©Doroå½¢è±¡</h4>
                            <div class="doro-selector-container">
                                <div class="doro-selector-tabs">
                                    <button class="doro-tab active" onclick="switchDoroTab('preset')">é¢„è®¾Doro</button>
                                    <button class="doro-tab" onclick="switchDoroTab('custom')">è‡ªå®šä¹‰Doro</button>
                                </div>
                                <div class="doro-selector-grid" id="doroSelectorGrid">
                                    <!-- åŠ¨æ€åŠ è½½Doroåˆ—è¡¨ -->
                                </div>
                                <div class="doro-upload-custom" id="doroUploadCustom" style="display: none;">
                                    <div class="upload-area" onclick="document.getElementById('doroCustomInput').click()">
                                        <input type="file" id="doroCustomInput" accept="image/*" style="display: none;" onchange="handleCustomDoro(event)">
                                        <div class="upload-placeholder">
                                            <div class="upload-icon">â•</div>
                                            <p>ä¸Šä¼ è‡ªå®šä¹‰Doroå½¢è±¡</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å¯é€‰ï¼šæœè£…é£æ ¼å‚è€ƒ -->
                    <div class="upload-section">
                        <div class="upload-group">
                            <h4>ğŸ‘” æœè£…é£æ ¼å‚è€ƒï¼ˆå¯é€‰ï¼‰</h4>
                            <div class="upload-area" id="stylePhotoArea" onclick="document.getElementById('doroStyleInput').click()">
                                <input type="file" id="doroStyleInput" accept="image/*" style="display: none;" onchange="handleDoroStylePhoto(event)">
                                <div class="upload-placeholder" id="stylePlaceholder">
                                    <div class="upload-icon">ğŸ‘”</div>
                                    <p>ç‚¹å‡»ä¸Šä¼ æœè£…é£æ ¼å‚è€ƒ</p>
                                    <p class="upload-hint">å¯é€‰ï¼šç”¨äºç»Ÿä¸€æœè£…é£æ ¼</p>
                                </div>
                                <img id="doroStylePreview" class="upload-preview" style="display: none;" alt="é£æ ¼å‚è€ƒ">
                            </div>
                        </div>
                        
                        <div class="upload-group">
                            <h4>âœï¸ è‡ªå®šä¹‰æç¤ºè¯ï¼ˆå¯é€‰ï¼‰</h4>
                            <textarea id="doroCustomPrompt" placeholder="è¾“å…¥é¢å¤–è¦æ±‚ï¼Œå°†è¿½åŠ åˆ°åŸºç¡€æç¤ºè¯åé¢ã€‚ä¾‹å¦‚ï¼šæŒ‰ç¬¬äºŒä¸ªæ©™è‰²é«˜å­ç”·ç”Ÿï¼Œæ¢ä»–çš„è¡£æœå’Œè£¤å­æœè£…ï¼Œå¤´åƒæ›´æ¢æˆå½“å‰ä¸»äººçš„å¤´åƒï¼Œåªä¿ç•™ä¸€ä¸ªäºº" rows="3"></textarea>
                        </div>
                    </div>
                    
                    <!-- æ“ä½œæŒ‰é’® -->
                    <div class="doro-actions">
                        <button class="doro-generate-btn" id="doroGenerateBtn" onclick="generateDoroSelfie()" disabled>
                            âœ¨ ç”ŸæˆDoroåˆå½±
                        </button>
                        <button class="doro-cancel-btn" onclick="closeDoroModal()">
                            âŒ å–æ¶ˆ
                        </button>
                    </div>

                    
                    <!-- åŠ è½½çŠ¶æ€ -->
                    <div class="doro-loading" id="doroLoading" style="display: none;">
                        <div class="loading-content">
                            <div class="doro-spinner"></div>
                            <h4 class="loading-title">æ­£åœ¨ç”ŸæˆDoroåˆå½±...</h4>
                            <p class="loading-hint">AIæ­£åœ¨å°†æ‚¨ã€Doroå’Œæ™¯ç‚¹å®Œç¾èåˆ ğŸ¨</p>
                            <p class="loading-hint">é¢„è®¡éœ€è¦ 15-30 ç§’ â°</p>
                        </div>
                    </div>
                    
                    <!-- ç»“æœå±•ç¤º -->
                    <div class="doro-result" id="doroResult" style="display: none;">
                        <div class="generated-image-container">
                            <img id="generatedDoroSelfie" class="generated-selfie" alt="Doroåˆå½±" onclick="showImageModal(this.src)">
                            <div class="image-hint">ç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾</div>
                        </div>
                        <div class="result-actions">
                            <button class="download-btn" onclick="downloadDoroSelfie()">
                                ğŸ’¾ ä¸‹è½½åˆå½±
                            </button>
                            <button class="regenerate-btn" onclick="regenerateDoroSelfie()">
                                ğŸ”„ é‡æ–°ç”Ÿæˆ
                            </button>
                            <button class="share-btn" onclick="shareDoroSelfie()">
                                ğŸ“¤ åˆ†äº«åˆå½±
                            </button>
                        </div>
                    </div>
                    
                    
                    <!-- é”™è¯¯æç¤º -->
                    <div class="doro-error" id="doroError" style="display: none;">
                        <div class="error-icon">ğŸ¤–ğŸ’¥</div>
                        <h4>AIæŠ›é”šäº†</h4>
                        <p id="doroErrorMessage">è¿™ç‚¹å°æ•…éšœï¼Œä½ çœ‹è‚¿ä¹ˆåŠï¼Ÿ</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Doroåˆå½±é®ç½©å±‚ -->
        <div class="doro-overlay" id="doroOverlay" style="display: none;"></div>
    </div>

    <!-- Google Maps JavaScript API é…ç½® -->
    <script>
        // APIåŸºç¡€URLé…ç½® - æ”¯æŒç¯å¢ƒå˜é‡æ§åˆ¶
        function getAPIBaseURL() {
            // æ£€æŸ¥æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆé€šè¿‡åŸŸåè®¿é—®ï¼‰
            const isProduction = window.location.hostname === 'spot.gitagent.io' ||
                                 window.location.hostname.includes('gitagent.io');
            
            // æ£€æŸ¥localStorageä¸­çš„é…ç½®ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
            const localStorageConfig = localStorage.getItem('isUsedomainnameaddress');
            
            // æ£€æŸ¥URLå‚æ•°
            const urlHasUseDomain = window.location.search.includes('usedomainname=true');
            const urlHasUseLocal = window.location.search.includes('usedomainname=false');
            
            // å†³å®šä½¿ç”¨å“ªä¸ªAPI URL
            if (localStorageConfig === 'false' && !isProduction) {
                // æ˜ç¡®è®¾ç½®ä¸ºæœ¬åœ°å¼€å‘
                return 'http://localhost:8001';
            } else if (localStorageConfig === 'true' || urlHasUseDomain || isProduction) {
                // ç”Ÿäº§ç¯å¢ƒæˆ–æ˜ç¡®è®¾ç½®ä½¿ç”¨åŸŸå
                return 'https://spot.gitagent.io';
            } else if (urlHasUseLocal) {
                // URLå‚æ•°æ˜ç¡®æŒ‡å®šä½¿ç”¨æœ¬åœ°
                return 'http://localhost:8001';
            } else {
                // é»˜è®¤ï¼šå¦‚æœé€šè¿‡åŸŸåè®¿é—®åˆ™ä½¿ç”¨åŸŸåï¼Œå¦åˆ™ä½¿ç”¨æœ¬åœ°
                return isProduction ? 'https://spot.gitagent.io' : 'http://localhost:8001';
            }
        }
        
        const API_BASE_URL = getAPIBaseURL();
        window.API_BASE_URL = API_BASE_URL; // è®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œä¾›iframeä½¿ç”¨
        console.log('ğŸ”§ API_BASE_URLé…ç½®:', API_BASE_URL);
        
        // åº”ç”¨é…ç½® - API Keyé…ç½®åœ¨ç¯å¢ƒå˜é‡ä¸­
        window.appConfig = {
            // æ³¨æ„ï¼šå®é™…éƒ¨ç½²æ—¶åº”ä»åç«¯æˆ–ç¯å¢ƒå˜é‡è·å–æ­¤å€¼
            // ä¸è¦å°†çœŸå®çš„API Keyæäº¤åˆ°ä»£ç åº“ï¼
            // å¼€å‘æ—¶è¯·åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½® GOOGLE_MAPS_API_KEY
            googleMapsApiKey: 'AIzaSyC3fc8-5r4SWOISs0IIduiE4TOvE8-aFC0', // å°†è¢«åŠ¨æ€æ›¿æ¢
            useLangchain: true
        };

        // å°è¯•ä»åç«¯è·å–APIé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰
        async function loadAppConfig() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/config/maps`);
                if (response.ok) {
                    const config = await response.json();
                    window.appConfig.googleMapsApiKey = config.google_maps_api_key;
                    console.log('âœ… ä»åç«¯è·å–åˆ°APIé…ç½®');
                }
            } catch (error) {
                console.log('âš ï¸ æ— æ³•ä»åç«¯è·å–APIé…ç½®ï¼Œä½¿ç”¨é»˜è®¤é…ç½®');
            }
        }

        // æ·»åŠ å…¨å±€çŠ¶æ€å˜é‡
        window.googleMapsLoadStatus = 'pending'; // pending, loading, loaded, failed

        // Google Maps API å›è°ƒå‡½æ•°
        window.initGoogleMaps = function() {
            console.log('âœ… Google Maps API å·²åŠ è½½');
            console.log('ğŸ™ï¸ Street View æœåŠ¡å·²å‡†å¤‡å°±ç»ª');
            window.googleMapsLoadStatus = 'loaded';

            // åˆå§‹åŒ–è¡—æ™¯ç›¸å…³å˜é‡
            if (typeof initGoogleMapsAPI === 'function') {
                initGoogleMapsAPI();
            }
            
            // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œé€šçŸ¥APIå·²åŠ è½½
            window.dispatchEvent(new Event('googleMapsLoaded'));
        };

        // åŠ¨æ€åŠ è½½Google Maps API
        function loadGoogleMapsAPI() {
            const apiKey = window.appConfig.googleMapsApiKey;
            
            console.log('ğŸ” å¼€å§‹åŠ è½½Google Maps API');
            console.log('   API Key:', apiKey ? apiKey.substring(0, 10) + '...' : 'æœªè®¾ç½®');

            if (!apiKey || apiKey === 'YOUR_GOOGLE_MAPS_API_KEY') {
                console.warn('âš ï¸ Google Maps API Key æœªé…ç½®');
                window.googleMapsLoadStatus = 'failed';
                return false;
            }

            // æ£€æŸ¥æ˜¯å¦å·²ç»åŠ è½½è¿‡
            if (window.google && window.google.maps) {
                console.log('âœ… Google Maps API å·²å­˜åœ¨');
                window.googleMapsLoadStatus = 'loaded';
                window.initGoogleMaps();
                return true;
            }

            window.googleMapsLoadStatus = 'loading';
            console.log('ğŸ”„ æ­£åœ¨åŠ è½½ Google Maps API...');
            
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=initGoogleMaps&v=weekly&libraries=geometry`;
            script.async = true;
            script.defer = true;
            
            script.onload = function() {
                console.log('âœ… Google Maps scriptæ ‡ç­¾åŠ è½½å®Œæˆ');
            };
            
            script.onerror = function(error) {
                window.googleMapsLoadStatus = 'failed';
                console.error('âŒ Google Maps API åŠ è½½å¤±è´¥');
                console.log('ğŸ” è¯·æ£€æŸ¥:');
                console.log('   1. API Key æ˜¯å¦æ­£ç¡®');
                console.log('   2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸');
                console.log('   3. API Key æ˜¯å¦æœ‰æ­£ç¡®çš„æƒé™');
                console.log('   4. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰å…¶ä»–é”™è¯¯');
            };
            
            document.head.appendChild(script);
            return true;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ğŸš€ OrientDiscover åº”ç”¨å¯åŠ¨');

            // å…ˆå°è¯•åŠ è½½é…ç½®
            await loadAppConfig();

            // ç„¶ååŠ è½½Google Maps API
            loadGoogleMapsAPI();
        });
    </script>

    <script src="i18n/index.js"></script>
    <script src="app.js"></script>
    
    <!-- è®¤è¯æ¨¡æ€æ¡† -->
    <div id="auth-modal" class="auth-modal hidden">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h2 id="modal-title">ç”¨æˆ·è®¤è¯</h2>
                <button class="close-btn" onclick="closeAuthModal()">Ã—</button>
            </div>
            <div class="auth-modal-body">
                <iframe src="auth-modal.html" width="100%" height="500" frameborder="0"></iframe>
            </div>
        </div>
    </div>
    
    <script>
        // å¤šè¯­è¨€å’Œè®¤è¯ç›¸å…³åŠŸèƒ½
        // currentLanguage åœ¨ app.js ä¸­å·²å£°æ˜
        let currentUser = null;
        
        // ç¿»è¯‘æ•°æ®
        const translations = {
            zh: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "ç”¨æˆ·",
                guest: "æ¸¸å®¢",
                login: "ç™»å½•",
                register: "æ³¨å†Œ",
                logout: "é€€å‡ºç™»å½•",
                notLoggedIn: "æœªç™»å½•",
                currentLocation: "å½“å‰ä½ç½®",
                nearbyAttractions: "é™„è¿‘æ™¯ç‚¹",
                exploreHere: "æ¼«æ¸¸åˆ°è¿™é‡Œ",
                generatePhoto: "ç”Ÿæˆåˆå½±",
                viewStreetView: "æŸ¥çœ‹è¡—æ™¯",
                doroPhoto: "Doroåˆå½±",
                noAttractionsFound: "æ²¡æœ‰æ‰¾åˆ°ç›¸å…³åœ°ç‚¹ä¿¡æ¯",
                searching: "æœç´¢ä¸­...",
                loading: "åŠ è½½ä¸­...",
                distance: "è·ç¦»",
                settings: "è®¾ç½®",
                targetDistance: "ç›®æ ‡è·ç¦»",
                mode: "æ¨¡å¼",
                speed: "é€Ÿåº¦ (km/h)",
                cityRoaming: "åŸå¸‚æ¼«æ¸¸",
                selectCity: "é€‰æ‹©åŸå¸‚",
                modernMode: "ç°ä»£æ¨¡å¼",
                ancientMode: "å¤ä»£æ¨¡å¼",
                coordinates: "ç»çº¬åº¦",
                accuracy: "ç²¾åº¦",
                compassDirection: "æœå‘",
                directionText: "æ–¹å‘",
                startExploration: "å¼€å§‹æ¢ç´¢",
                refreshLocation: "åˆ·æ–°ä½ç½®",
                endJourney: "ç»“æŸæ—…ç¨‹",
                visitedPlaces: "å·²è®¿é—®çš„åœ°ç‚¹",
                systemLog: "ç³»ç»Ÿæ—¥å¿—",
                clearLogs: "æ¸…ç©ºæ—¥å¿—",
                viewAttractions: "æŸ¥çœ‹æ™¯ç‚¹",
                randomRoaming: "éšæœºæ¼«æ¸¸",
                cityRoaming: "åŸå¸‚æ¼«æ¸¸",
                selectCity: "é€‰æ‹©åŸå¸‚",
                searchCity: "æœç´¢åŸå¸‚",
                pleaseSelectCity: "-- è¯·é€‰æ‹©åŸå¸‚ --",
                enterCityName: "è¾“å…¥åŸå¸‚åç§°æœç´¢...",
                globalCities: "å…¨çƒçŸ¥ååŸå¸‚",
                chinaCities: "ä¸­å›½çŸ¥ååŸå¸‚",
                loadingCityInfo: "æ­£åœ¨åŠ è½½åŸå¸‚ä¿¡æ¯...",
                streetView: "è¡—æ™¯è§†å›¾",
                resetView: "é‡ç½®è§†è§’",
                fullscreen: "å…¨å±",
                share: "åˆ†äº«",
                loadingStreetView: "æ­£åœ¨åŠ è½½è¡—æ™¯...",
                streetViewUnavailable: "è¡—æ™¯ä¸å¯ç”¨",
                retry: "é‡è¯•",
                location: "ä½ç½®",
                coordinates: "åæ ‡",
                shootingTime: "æ‹æ‘„æ—¶é—´",
                generateSelfie: "ç”Ÿæˆæ™¯ç‚¹åˆå½±",
                attractionName: "æ™¯ç‚¹åç§°",
                locationInfo: "ä½ç½®ä¿¡æ¯",
                yourPhoto: "æ‚¨çš„ç…§ç‰‡",
                clickToUpload: "ç‚¹å‡»ä¸Šä¼ æ‚¨çš„ç…§ç‰‡",
                supportFormats: "æ”¯æŒ JPGã€PNG æ ¼å¼",
                stylePhoto: "èŒƒä¾‹é£æ ¼å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰",
                clickToUploadStyle: "ç‚¹å‡»ä¸Šä¼ èŒƒä¾‹é£æ ¼å›¾ç‰‡",
                styleHint: "ç”¨äºæ¨¡ä»¿æœè£…æˆ–é£æ ¼",
                customPrompt: "è‡ªå®šä¹‰æç¤ºè¯ï¼ˆå¯é€‰ï¼‰",
                customPromptPlaceholder: "è¾“å…¥é¢å¤–è¦æ±‚ï¼Œå°†è¿½åŠ åˆ°åŸºç¡€æç¤ºè¯åé¢ã€‚ä¾‹å¦‚ï¼šæŒ‰ç¬¬äºŒä¸ªæ©™è‰²é«˜å­ç”·ç”Ÿï¼Œæ¢ä»–çš„è¡£æœå’Œè£¤å­æœè£…ï¼Œå¤´åƒæ›´æ¢æˆå½“å‰ä¸»äººçš„å¤´åƒï¼Œåªä¿ç•™ä¸€ä¸ªäºº",
                generate: "ç”Ÿæˆåˆå½±",
                cancel: "å–æ¶ˆ",
                generatingSelfie: "æ­£åœ¨ç”Ÿæˆæ‚¨çš„æ™¯ç‚¹åˆå½±...",
                generatingHint: "è¿™å¯èƒ½éœ€è¦ 10-30 ç§’ï¼Œè¯·è€å¿ƒç­‰å¾… â°",
                clickImageToView: "ç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾",
                downloadPhoto: "ä¸‹è½½åˆå½±",
                regenerateWithStyle: "å½“å‰é£æ ¼é‡æ–°ç”Ÿæˆ",
                sharePhoto: "åˆ†äº«åˆå½±",
                generationFailed: "ç”Ÿæˆå¤±è´¥",
                generationError: "ç”Ÿæˆåˆå½±æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•",
                doroSelfie: "Doroä¸æˆ‘åˆå½±",
                doroSubtitle: "åˆ›å»ºæ‚¨ä¸è™šæ‹Ÿä¼™ä¼´Doroçš„ç²¾å½©åˆå½±",
                selectDoro: "é€‰æ‹©Doroå½¢è±¡",
                presetDoro: "é¢„è®¾Doro",
                customDoro: "è‡ªå®šä¹‰Doro",
                uploadCustomDoro: "ä¸Šä¼ è‡ªå®šä¹‰Doroå½¢è±¡",
                styleReference: "æœè£…é£æ ¼å‚è€ƒï¼ˆå¯é€‰ï¼‰",
                clickToUploadStyle: "ç‚¹å‡»ä¸Šä¼ æœè£…é£æ ¼å‚è€ƒ",
                styleReferenceHint: "å¯é€‰ï¼šç”¨äºç»Ÿä¸€æœè£…é£æ ¼",
                customPromptDoro: "è‡ªå®šä¹‰æç¤ºè¯ï¼ˆå¯é€‰ï¼‰",
                generateDoroSelfie: "ç”ŸæˆDoroåˆå½±",
                generatingDoroSelfie: "æ­£åœ¨ç”ŸæˆDoroåˆå½±...",
                generatingDoroHint: "AIæ­£åœ¨å°†æ‚¨ã€Doroå’Œæ™¯ç‚¹å®Œç¾èåˆ ğŸ¨",
                generatingDoroTime: "é¢„è®¡éœ€è¦ 15-30 ç§’ â°",
                doroError: "AIæŠ›é”šäº†",
                doroErrorMessage: "è¿™ç‚¹å°æ•…éšœï¼Œä½ çœ‹è‚¿ä¹ˆåŠï¼Ÿ"
            },
            en: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "User",
                guest: "Guest",
                login: "Login",
                register: "Register",
                logout: "Logout",
                notLoggedIn: "Not Logged In",
                currentLocation: "Current Location",
                nearbyAttractions: "Nearby Attractions",
                exploreHere: "Roam to Here",
                generatePhoto: "Generate Photo",
                viewStreetView: "View Street View",
                doroPhoto: "Doro Photo",
                noAttractionsFound: "No relevant location information found",
                searching: "Searching...",
                loading: "Loading...",
                distance: "Distance",
                settings: "Settings",
                targetDistance: "Target Distance",
                mode: "Mode",
                speed: "Speed (km/h)",
                cityRoaming: "City Roaming",
                selectCity: "Select City",
                modernMode: "Modern Mode",
                ancientMode: "Ancient Mode",
                coordinates: "Coordinates",
                accuracy: "Accuracy",
                compassDirection: "Heading",
                directionText: "Direction",
                startExploration: "Start Exploration",
                refreshLocation: "Refresh Location",
                endJourney: "End Journey",
                visitedPlaces: "Visited Places",
                systemLog: "System Log",
                clearLogs: "Clear Logs",
                viewAttractions: "View Attractions",
                randomRoaming: "Random Roaming",
                cityRoaming: "City Roaming",
                selectCity: "Select City",
                searchCity: "Search City",
                pleaseSelectCity: "-- Please select city --",
                enterCityName: "Enter city name to search...",
                globalCities: "Global Famous Cities",
                chinaCities: "China Famous Cities",
                loadingCityInfo: "Loading city information...",
                streetView: "Street View",
                resetView: "Reset View",
                fullscreen: "Fullscreen",
                share: "Share",
                loadingStreetView: "Loading Street View...",
                streetViewUnavailable: "Street View Unavailable",
                retry: "Retry",
                location: "Location",
                coordinates: "Coordinates",
                shootingTime: "Shooting Time",
                generateSelfie: "Generate Selfie",
                attractionName: "Attraction Name",
                locationInfo: "Location Info",
                yourPhoto: "Your Photo",
                clickToUpload: "Click to upload your photo",
                supportFormats: "Supports JPG, PNG formats",
                stylePhoto: "Style Reference Photo (Optional)",
                clickToUploadStyle: "Click to upload style reference",
                styleHint: "For imitating clothing or style",
                customPrompt: "Custom Prompt (Optional)",
                customPromptPlaceholder: "Enter additional requirements to append to the base prompt. For example: Follow the second orange tall boy, change his clothes and pants, replace the head with the current owner's head, keep only one person",
                generate: "Generate Photo",
                cancel: "Cancel",
                generatingSelfie: "Generating your attraction selfie...",
                generatingHint: "This may take 10-30 seconds, please be patient â°",
                clickImageToView: "Click image to view full size",
                downloadPhoto: "Download Photo",
                regenerateWithStyle: "Regenerate with Current Style",
                sharePhoto: "Share Photo",
                generationFailed: "Generation Failed",
                generationError: "Error generating selfie, please try again",
                doroSelfie: "Doro & Me Selfie",
                doroSubtitle: "Create amazing selfies with your virtual companion Doro",
                selectDoro: "Select Doro Character",
                presetDoro: "Preset Doro",
                customDoro: "Custom Doro",
                uploadCustomDoro: "Upload Custom Doro Character",
                styleReference: "Clothing Style Reference (Optional)",
                clickToUploadStyle: "Click to upload clothing style reference",
                styleReferenceHint: "Optional: for unified clothing style",
                customPromptDoro: "Custom Prompt (Optional)",
                generateDoroSelfie: "Generate Doro Selfie",
                generatingDoroSelfie: "Generating Doro selfie...",
                generatingDoroHint: "AI is perfectly blending you, Doro and the attraction ğŸ¨",
                generatingDoroTime: "Estimated 15-30 seconds â°",
                doroError: "AI Broke Down",
                doroErrorMessage: "This little glitch, what do you think we should do?"
            },
            es: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "Usuario",
                guest: "Invitado",
                login: "Iniciar SesiÃ³n",
                register: "Registrarse",
                logout: "Cerrar SesiÃ³n",
                notLoggedIn: "No Conectado",
                currentLocation: "UbicaciÃ³n Actual",
                nearbyAttractions: "Atracciones Cercanas",
                exploreHere: "Explorar AquÃ­",
                generatePhoto: "Generar Foto",
                viewStreetView: "Ver Vista de Calle",
                doroPhoto: "Foto Doro",
                noAttractionsFound: "No se encontrÃ³ informaciÃ³n de ubicaciÃ³n relevante",
                searching: "Buscando...",
                loading: "Cargando...",
                distance: "Distancia",
                settings: "ConfiguraciÃ³n",
                targetDistance: "Distancia Objetivo",
                mode: "Modo",
                speed: "Velocidad (km/h)",
                cityRoaming: "Paseo por la Ciudad",
                selectCity: "Seleccionar Ciudad",
                modernMode: "Modo Moderno",
                ancientMode: "Modo Antiguo"
            },
            fr: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "Utilisateur",
                guest: "InvitÃ©",
                login: "Connexion",
                register: "Inscription",
                logout: "DÃ©connexion",
                notLoggedIn: "Non ConnectÃ©",
                currentLocation: "Localisation Actuelle",
                nearbyAttractions: "Attractions Proches",
                exploreHere: "Explorer Ici",
                generatePhoto: "GÃ©nÃ©rer Photo",
                viewStreetView: "Voir Vue de Rue",
                doroPhoto: "Photo Doro",
                noAttractionsFound: "Aucune information de localisation pertinente trouvÃ©e",
                searching: "Recherche...",
                loading: "Chargement...",
                distance: "Distance",
                settings: "ParamÃ¨tres",
                targetDistance: "Distance Cible",
                mode: "Mode",
                speed: "Vitesse (km/h)",
                cityRoaming: "Promenade Urbaine",
                selectCity: "SÃ©lectionner Ville",
                modernMode: "Mode Moderne",
                ancientMode: "Mode Ancien"
            },
            de: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "Benutzer",
                guest: "Gast",
                login: "Anmelden",
                register: "Registrieren",
                logout: "Abmelden",
                notLoggedIn: "Nicht Angemeldet",
                currentLocation: "Aktuelle Position",
                nearbyAttractions: "Nahegelegene SehenswÃ¼rdigkeiten",
                exploreHere: "Hier Erkunden",
                generatePhoto: "Foto Generieren",
                viewStreetView: "StraÃŸenansicht Anzeigen",
                doroPhoto: "Doro Foto",
                noAttractionsFound: "Keine relevanten Standortinformationen gefunden",
                searching: "Suche...",
                loading: "Laden...",
                distance: "Entfernung",
                settings: "Einstellungen",
                targetDistance: "Zieldistanz",
                mode: "Modus",
                speed: "Geschwindigkeit (km/h)",
                cityRoaming: "Stadtbummel",
                selectCity: "Stadt AuswÃ¤hlen",
                modernMode: "Moderner Modus",
                ancientMode: "Antiker Modus"
            },
            ja: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "ãƒ¦ãƒ¼ã‚¶ãƒ¼",
                guest: "ã‚²ã‚¹ãƒˆ",
                login: "ãƒ­ã‚°ã‚¤ãƒ³",
                register: "æ–°è¦ç™»éŒ²",
                logout: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
                notLoggedIn: "æœªãƒ­ã‚°ã‚¤ãƒ³",
                currentLocation: "ç¾åœ¨åœ°",
                nearbyAttractions: "è¿‘ãã®è¦³å…‰åœ°",
                exploreHere: "ã“ã“ã‚’æ¢ç´¢",
                generatePhoto: "å†™çœŸã‚’ç”Ÿæˆ",
                viewStreetView: "ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ã‚’è¦‹ã‚‹",
                doroPhoto: "Doroå†™çœŸ",
                noAttractionsFound: "é–¢é€£ã™ã‚‹å ´æ‰€æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
                searching: "æ¤œç´¢ä¸­...",
                loading: "èª­ã¿è¾¼ã¿ä¸­...",
                distance: "è·é›¢",
                settings: "è¨­å®š",
                targetDistance: "ç›®æ¨™è·é›¢",
                mode: "ãƒ¢ãƒ¼ãƒ‰",
                speed: "é€Ÿåº¦ (km/h)",
                cityRoaming: "è¡—æ­©ã",
                selectCity: "éƒ½å¸‚ã‚’é¸æŠ",
                modernMode: "ãƒ¢ãƒ€ãƒ³ãƒ¢ãƒ¼ãƒ‰",
                ancientMode: "å¤ä»£ãƒ¢ãƒ¼ãƒ‰"
            },
            ko: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "ì‚¬ìš©ì",
                guest: "ê²ŒìŠ¤íŠ¸",
                login: "ë¡œê·¸ì¸",
                register: "íšŒì›ê°€ì…",
                logout: "ë¡œê·¸ì•„ì›ƒ",
                notLoggedIn: "ë¡œê·¸ì¸ ì•ˆë¨",
                currentLocation: "í˜„ì¬ ìœ„ì¹˜",
                nearbyAttractions: "ì£¼ë³€ ê´€ê´‘ì§€",
                exploreHere: "ì—¬ê¸° íƒí—˜í•˜ê¸°",
                generatePhoto: "ì‚¬ì§„ ìƒì„±",
                viewStreetView: "ìŠ¤íŠ¸ë¦¬íŠ¸ë·° ë³´ê¸°",
                doroPhoto: "Doro ì‚¬ì§„",
                noAttractionsFound: "ê´€ë ¨ ìœ„ì¹˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
                searching: "ê²€ìƒ‰ ì¤‘...",
                loading: "ë¡œë”© ì¤‘...",
                distance: "ê±°ë¦¬",
                settings: "ì„¤ì •",
                targetDistance: "ëª©í‘œ ê±°ë¦¬",
                mode: "ëª¨ë“œ",
                speed: "ì†ë„ (km/h)",
                cityRoaming: "ë„ì‹œ ì‚°ì±…",
                selectCity: "ë„ì‹œ ì„ íƒ",
                modernMode: "ëª¨ë˜ ëª¨ë“œ",
                ancientMode: "ê³ ëŒ€ ëª¨ë“œ"
            },
            it: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "Utente",
                guest: "Ospite",
                login: "Accedi",
                register: "Registrati",
                logout: "Disconnetti",
                notLoggedIn: "Non Connesso",
                currentLocation: "Posizione Attuale",
                nearbyAttractions: "Attrazioni Vicine",
                exploreHere: "Esplora Qui",
                generatePhoto: "Genera Foto",
                viewStreetView: "Visualizza Street View",
                doroPhoto: "Foto Doro",
                noAttractionsFound: "Nessuna informazione di posizione rilevante trovata",
                searching: "Ricerca...",
                loading: "Caricamento...",
                distance: "Distanza",
                settings: "Impostazioni",
                targetDistance: "Distanza Obiettivo",
                mode: "ModalitÃ ",
                speed: "VelocitÃ  (km/h)",
                cityRoaming: "Passeggiata in CittÃ ",
                selectCity: "Seleziona CittÃ ",
                modernMode: "ModalitÃ  Moderna",
                ancientMode: "ModalitÃ  Antica"
            },
            pt: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "UsuÃ¡rio",
                guest: "Convidado",
                login: "Entrar",
                register: "Registrar",
                logout: "Sair",
                notLoggedIn: "NÃ£o Conectado",
                currentLocation: "LocalizaÃ§Ã£o Atual",
                nearbyAttractions: "AtraÃ§Ãµes PrÃ³ximas",
                exploreHere: "Explorar Aqui",
                generatePhoto: "Gerar Foto",
                viewStreetView: "Ver Vista de Rua",
                doroPhoto: "Foto Doro",
                noAttractionsFound: "Nenhuma informaÃ§Ã£o de localizaÃ§Ã£o relevante encontrada",
                searching: "Pesquisando...",
                loading: "Carregando...",
                distance: "DistÃ¢ncia",
                settings: "ConfiguraÃ§Ãµes",
                targetDistance: "DistÃ¢ncia Alvo",
                mode: "Modo",
                speed: "Velocidade (km/h)",
                cityRoaming: "Passeio pela Cidade",
                selectCity: "Selecionar Cidade",
                modernMode: "Modo Moderno",
                ancientMode: "Modo Antigo"
            },
            ru: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ",
                guest: "Ğ“Ğ¾ÑÑ‚ÑŒ",
                login: "Ğ’Ğ¾Ğ¹Ñ‚Ğ¸",
                register: "Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ",
                logout: "Ğ’Ñ‹Ğ¹Ñ‚Ğ¸",
                notLoggedIn: "ĞĞµ Ğ’Ğ¾Ğ¹Ğ´ĞµĞ½",
                currentLocation: "Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ĞœĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ",
                nearbyAttractions: "Ğ‘Ğ»Ğ¸Ğ·Ğ»ĞµĞ¶Ğ°Ñ‰Ğ¸Ğµ Ğ”Ğ¾ÑÑ‚Ğ¾Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸",
                exploreHere: "Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ—Ğ´ĞµÑÑŒ",
                generatePhoto: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¤Ğ¾Ñ‚Ğ¾",
                viewStreetView: "ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ĞŸĞ°Ğ½Ğ¾Ñ€Ğ°Ğ¼Ñƒ",
                doroPhoto: "Ğ¤Ğ¾Ñ‚Ğ¾ Ğ”Ğ¾Ñ€Ğ¾",
                noAttractionsFound: "ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸",
                searching: "ĞŸĞ¾Ğ¸ÑĞº...",
                loading: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...",
                distance: "Ğ Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ",
                settings: "ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸",
                targetDistance: "Ğ¦ĞµĞ»ĞµĞ²Ğ¾Ğµ Ğ Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ",
                mode: "Ğ ĞµĞ¶Ğ¸Ğ¼",
                speed: "Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ (ĞºĞ¼/Ñ‡)",
                cityRoaming: "Ğ“Ğ¾Ñ€Ğ¾Ğ´ÑĞºĞ°Ñ ĞŸÑ€Ğ¾Ğ³ÑƒĞ»ĞºĞ°",
                selectCity: "Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ“Ğ¾Ñ€Ğ¾Ğ´",
                modernMode: "Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ ĞµĞ¶Ğ¸Ğ¼",
                ancientMode: "Ğ”Ñ€ĞµĞ²Ğ½Ğ¸Ğ¹ Ğ ĞµĞ¶Ğ¸Ğ¼"
            },
            ar: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                guest: "Ø¶ÙŠÙ",
                login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
                register: "Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
                logout: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
                notLoggedIn: "ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
                currentLocation: "Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ",
                nearbyAttractions: "Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©",
                exploreHere: "Ø§Ø³ØªÙƒØ´Ù Ù‡Ù†Ø§",
                generatePhoto: "Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø©",
                viewStreetView: "Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø§Ø±Ø¹",
                doroPhoto: "ØµÙˆØ±Ø© Ø¯ÙˆØ±Ùˆ",
                noAttractionsFound: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙˆÙ‚Ø¹ Ø°Ø§Øª ØµÙ„Ø©",
                searching: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...",
                loading: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
                distance: "Ø§Ù„Ù…Ø³Ø§ÙØ©",
                settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
                targetDistance: "Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©",
                mode: "Ø§Ù„ÙˆØ¶Ø¹",
                speed: "Ø§Ù„Ø³Ø±Ø¹Ø© (ÙƒÙ…/Ø³Ø§Ø¹Ø©)",
                cityRoaming: "ØªØ¬ÙˆÙ„ ÙÙŠ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©",
                selectCity: "Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©",
                modernMode: "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø¯ÙŠØ«",
                ancientMode: "Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø¯ÙŠÙ…"
            },
            hi: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾",
                guest: "à¤…à¤¤à¤¿à¤¥à¤¿",
                login: "à¤²à¥‰à¤— à¤‡à¤¨",
                register: "à¤°à¤œà¤¿à¤¸à¥à¤Ÿà¤°",
                logout: "à¤²à¥‰à¤— à¤†à¤‰à¤Ÿ",
                notLoggedIn: "à¤²à¥‰à¤— à¤‡à¤¨ à¤¨à¤¹à¥€à¤‚",
                currentLocation: "à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤¸à¥à¤¥à¤¾à¤¨",
                nearbyAttractions: "à¤ªà¤¾à¤¸ à¤•à¥‡ à¤†à¤•à¤°à¥à¤·à¤£",
                exploreHere: "à¤¯à¤¹à¤¾à¤ à¤…à¤¨à¥à¤µà¥‡à¤·à¤£ à¤•à¤°à¥‡à¤‚",
                generatePhoto: "à¤«à¥‹à¤Ÿà¥‹ à¤¬à¤¨à¤¾à¤à¤‚",
                viewStreetView: "à¤¸à¥à¤Ÿà¥à¤°à¥€à¤Ÿ à¤µà¥à¤¯à¥‚ à¤¦à¥‡à¤–à¥‡à¤‚",
                doroPhoto: "à¤¡à¥‹à¤°à¥‹ à¤«à¥‹à¤Ÿà¥‹",
                noAttractionsFound: "à¤¸à¤‚à¤¬à¤‚à¤§à¤¿à¤¤ à¤¸à¥à¤¥à¤¾à¤¨ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¥€",
                searching: "à¤–à¥‹à¤œ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚...",
                loading: "à¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¤¾ à¤¹à¥ˆ...",
                distance: "à¤¦à¥‚à¤°à¥€",
                settings: "à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸",
                targetDistance: "à¤²à¤•à¥à¤·à¥à¤¯ à¤¦à¥‚à¤°à¥€",
                mode: "à¤®à¥‹à¤¡",
                speed: "à¤—à¤¤à¤¿ (à¤•à¤¿à¤®à¥€/à¤˜à¤‚à¤Ÿà¤¾)",
                cityRoaming: "à¤¶à¤¹à¤° à¤­à¥à¤°à¤®à¤£",
                selectCity: "à¤¶à¤¹à¤° à¤šà¥à¤¨à¥‡à¤‚",
                modernMode: "à¤†à¤§à¥à¤¨à¤¿à¤• à¤®à¥‹à¤¡",
                ancientMode: "à¤ªà¥à¤°à¤¾à¤šà¥€à¤¨ à¤®à¥‹à¤¡"
            },
            tr: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "KullanÄ±cÄ±",
                guest: "Misafir",
                login: "GiriÅŸ Yap",
                register: "KayÄ±t Ol",
                logout: "Ã‡Ä±kÄ±ÅŸ Yap",
                notLoggedIn: "GiriÅŸ YapÄ±lmamÄ±ÅŸ",
                currentLocation: "Mevcut Konum",
                nearbyAttractions: "YakÄ±ndaki Turistik Yerler",
                exploreHere: "BurayÄ± KeÅŸfet",
                generatePhoto: "FotoÄŸraf OluÅŸtur",
                viewStreetView: "Sokak GÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ GÃ¶rÃ¼ntÃ¼le",
                doroPhoto: "Doro FotoÄŸrafÄ±",
                noAttractionsFound: "Ä°lgili konum bilgisi bulunamadÄ±",
                searching: "AranÄ±yor...",
                loading: "YÃ¼kleniyor...",
                distance: "Mesafe",
                settings: "Ayarlar",
                targetDistance: "Hedef Mesafe",
                mode: "Mod",
                speed: "HÄ±z (km/saat)",
                cityRoaming: "Åehir Gezisi",
                selectCity: "Åehir SeÃ§",
                modernMode: "Modern Mod",
                ancientMode: "Antik Mod"
            },
            nl: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "Gebruiker",
                guest: "Gast",
                login: "Inloggen",
                register: "Registreren",
                logout: "Uitloggen",
                notLoggedIn: "Niet Ingelogd",
                currentLocation: "Huidige Locatie",
                nearbyAttractions: "Nabijgelegen Bezienswaardigheden",
                exploreHere: "Verken Hier",
                generatePhoto: "Foto Genereren",
                viewStreetView: "Straatweergave Bekijken",
                doroPhoto: "Doro Foto",
                noAttractionsFound: "Geen relevante locatie-informatie gevonden",
                searching: "Zoeken...",
                loading: "Laden...",
                distance: "Afstand",
                settings: "Instellingen",
                targetDistance: "Doelafstand",
                mode: "Modus",
                speed: "Snelheid (km/h)",
                cityRoaming: "Stadswandeling",
                selectCity: "Stad Selecteren",
                modernMode: "Moderne Modus",
                ancientMode: "Oude Modus"
            },
            he: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "××©×ª××©",
                guest: "××•×¨×—",
                login: "×”×ª×—×‘×¨",
                register: "×”×™×¨×©×",
                logout: "×”×ª× ×ª×§",
                notLoggedIn: "×œ× ××—×•×‘×¨",
                currentLocation: "××™×§×•× × ×•×›×—×™",
                nearbyAttractions: "××˜×¨×§×¦×™×•×ª ×§×¨×•×‘×•×ª",
                exploreHere: "×—×§×•×¨ ×›××Ÿ",
                generatePhoto: "×¦×•×¨ ×ª××•× ×”",
                viewStreetView: "×”×¦×’ ×ª×¦×•×’×ª ×¨×—×•×‘",
                doroPhoto: "×ª××•× ×ª ×“×•×¨×•",
                noAttractionsFound: "×œ× × ××¦× ××™×“×¢ ××™×§×•× ×¨×œ×•×•× ×˜×™",
                searching: "××—×¤×©...",
                loading: "×˜×•×¢×Ÿ...",
                distance: "××¨×—×§",
                settings: "×”×’×“×¨×•×ª",
                targetDistance: "××¨×—×§ ×™×¢×“",
                mode: "××¦×‘",
                speed: "××”×™×¨×•×ª (×§×/×©)",
                cityRoaming: "×˜×™×•×œ ×¢×™×¨×•× ×™",
                selectCity: "×‘×—×¨ ×¢×™×¨",
                modernMode: "××¦×‘ ××•×“×¨× ×™",
                ancientMode: "××¦×‘ ×¢×ª×™×§"
            },
            bg: {
                appTitle: "spot.gitagent.io",
                appSubtitle: "Discover your next spot!",
                user: "ĞŸĞ¾Ñ‚Ñ€ĞµĞ±Ğ¸Ñ‚ĞµĞ»",
                guest: "Ğ“Ğ¾ÑÑ‚",
                login: "Ğ’Ñ…Ğ¾Ğ´",
                register: "Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ",
                logout: "Ğ˜Ğ·Ñ…Ğ¾Ğ´",
                notLoggedIn: "ĞĞµ Ğµ Ğ²Ğ»ÑĞ·ÑŠĞ»",
                currentLocation: "Ğ¢ĞµĞºÑƒÑ‰Ğ¾ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ",
                nearbyAttractions: "Ğ‘Ğ»Ğ¸Ğ·ĞºĞ¸ Ğ·Ğ°Ğ±ĞµĞ»ĞµĞ¶Ğ¸Ñ‚ĞµĞ»Ğ½Ğ¾ÑÑ‚Ğ¸",
                exploreHere: "Ğ˜Ğ·ÑĞ»ĞµĞ´Ğ²Ğ°Ğ¹ Ñ‚ÑƒĞº",
                generatePhoto: "Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ°Ğ¹ ÑĞ½Ğ¸Ğ¼ĞºĞ°",
                viewStreetView: "Ğ’Ğ¸Ğ¶ ÑƒĞ»Ğ¸Ñ‡ĞµĞ½ Ğ¸Ğ·Ğ³Ğ»ĞµĞ´",
                doroPhoto: "Ğ”Ğ¾Ñ€Ğ¾ ÑĞ½Ğ¸Ğ¼ĞºĞ°",
                noAttractionsFound: "ĞĞµ Ğµ Ğ½Ğ°Ğ¼ĞµÑ€ĞµĞ½Ğ° Ñ€ĞµĞ»ĞµĞ²Ğ°Ğ½Ñ‚Ğ½Ğ° Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ·Ğ° Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ",
                searching: "Ğ¢ÑŠÑ€ÑĞµĞ½Ğµ...",
                loading: "Ğ—Ğ°Ñ€ĞµĞ¶Ğ´Ğ°Ğ½Ğµ...",
                distance: "Ğ Ğ°Ğ·ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ",
                settings: "ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸",
                targetDistance: "Ğ¦ĞµĞ»ĞµĞ²Ğ¾ Ñ€Ğ°Ğ·ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ",
                mode: "Ğ ĞµĞ¶Ğ¸Ğ¼",
                speed: "Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ (ĞºĞ¼/Ñ‡)",
                cityRoaming: "Ğ“Ñ€Ğ°Ğ´ÑĞºĞ° Ñ€Ğ°Ğ·Ñ…Ğ¾Ğ´ĞºĞ°",
                selectCity: "Ğ˜Ğ·Ğ±ĞµÑ€Ğ¸ Ğ³Ñ€Ğ°Ğ´",
                modernMode: "ĞœĞ¾Ğ´ĞµÑ€ĞµĞ½ Ñ€ĞµĞ¶Ğ¸Ğ¼",
                ancientMode: "Ğ”Ñ€ĞµĞ²ĞµĞ½ Ñ€ĞµĞ¶Ğ¸Ğ¼"
            }
        };
        
        // è®¾ç½®ç¿»è¯‘
        window.translations = translations;
        

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeLanguage();
            checkAuthStatus();
            setupAuthEventListeners();
        });

        function initializeLanguage() {
            currentLanguage = i18n.getCurrentLanguage();
            // è®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œä¾›iframeè®¿é—®
            window.currentLanguage = currentLanguage;
            updateLanguageUI();
            generateLanguageOptions();
            updateLanguageButton();
        }
        
        function updateLanguageUI() {
            const t = translations[currentLanguage] || translations['zh'];
            
            // æ›´æ–°é¡µé¢å…ƒç´ 
            document.getElementById('app-title').textContent = t.appTitle;
            document.getElementById('app-subtitle').textContent = t.appSubtitle;
            document.getElementById('user-name').textContent = currentUser ? currentUser.username : t.guest;
            document.getElementById('login-btn').textContent = t.login;
            document.getElementById('register-btn').textContent = t.register;
            document.getElementById('logout-btn').textContent = t.logout;
            
            // æ›´æ–°å…¶ä»–é¡µé¢å…ƒç´ 
            updatePageContent(t);
        }
        
        function updatePageContent(t) {
            // æ›´æ–°è®¾ç½®é¢æ¿
            const labels = document.querySelectorAll('.setting-group label');
            if (labels[0]) labels[0].textContent = t.targetDistance + ':';
            if (labels[1]) labels[1].textContent = t.mode + ':';
            if (labels[2]) labels[2].textContent = t.speed + ':';
            
            // æ›´æ–°é€‰é¡¹æ–‡æœ¬
            const options = document.querySelectorAll('option');
            options.forEach(option => {
                if (option.value === 'present') option.textContent = t.modernMode;
                if (option.value === 'past') option.textContent = t.ancientMode;
            });
            
            // æ›´æ–°çŠ¶æ€æ˜¾ç¤ºåŒºæ ‡ç­¾
            const currentLocationLabel = document.getElementById('currentLocationLabel');
            const coordinatesLabel = document.getElementById('coordinatesLabel');
            const accuracyLabel = document.getElementById('accuracyLabel');
            const compassDirectionLabel = document.getElementById('compassDirectionLabel');
            const directionTextLabel = document.getElementById('directionTextLabel');
            
            if (currentLocationLabel) currentLocationLabel.textContent = t.currentLocation + ':';
            if (coordinatesLabel) coordinatesLabel.textContent = t.coordinates + ':';
            if (accuracyLabel) accuracyLabel.textContent = t.accuracy + ':';
            if (compassDirectionLabel) compassDirectionLabel.textContent = t.compassDirection + ':';
            if (directionTextLabel) directionTextLabel.textContent = t.directionText + ':';
            
            // æ›´æ–°æ§åˆ¶æŒ‰é’®æ–‡æœ¬
            const startExplorationText = document.getElementById('startExplorationText');
            const refreshLocationText = document.getElementById('refreshLocationText');
            const endJourneyText = document.getElementById('endJourneyText');
            
            if (startExplorationText) startExplorationText.textContent = t.startExploration;
            if (refreshLocationText) refreshLocationText.textContent = t.refreshLocation;
            if (endJourneyText) endJourneyText.textContent = t.endJourney;
            
            // æ›´æ–°å…¶ä»–ç•Œé¢æ–‡æœ¬
            const visitedPlacesText = document.getElementById('visitedPlacesText');
            const systemLogText = document.getElementById('systemLogText');
            const clearLogsBtn = document.getElementById('clearLogsBtn');
            
            if (visitedPlacesText) visitedPlacesText.textContent = t.visitedPlaces;
            if (systemLogText) systemLogText.textContent = t.systemLog;
            if (clearLogsBtn) clearLogsBtn.textContent = t.clearLogs;
            
            // æ›´æ–°åŸå¸‚ç›¸å…³æŒ‰é’®
            const viewAttractionsText = document.getElementById('viewAttractionsText');
            const randomRoamingText = document.getElementById('randomRoamingText');
            
            if (viewAttractionsText) viewAttractionsText.textContent = t.viewAttractions;
            if (randomRoamingText) randomRoamingText.textContent = t.randomRoaming;
            
            // æ›´æ–°åŸå¸‚æ¼«æ¸¸ç›¸å…³å…ƒç´ 
            const cityRoamingTitle = document.getElementById('cityRoamingTitle');
            const selectCityLabel = document.getElementById('selectCityLabel');
            const searchCityLabel = document.getElementById('searchCityLabel');
            const pleaseSelectCityOption = document.getElementById('pleaseSelectCityOption');
            const globalCitiesGroup = document.getElementById('globalCitiesGroup');
            const chinaCitiesGroup = document.getElementById('chinaCitiesGroup');
            const citySearch = document.getElementById('citySearch');
            const roamingStatusText = document.getElementById('roamingStatusText');
            
            if (cityRoamingTitle) cityRoamingTitle.textContent = 'ğŸŒ ' + t.cityRoaming + ':';
            if (selectCityLabel) selectCityLabel.textContent = t.selectCity + ':';
            if (searchCityLabel) searchCityLabel.textContent = t.searchCity + ':';
            if (pleaseSelectCityOption) pleaseSelectCityOption.textContent = t.pleaseSelectCity;
            if (globalCitiesGroup) globalCitiesGroup.label = 'ğŸŒ ' + t.globalCities;
            if (chinaCitiesGroup) chinaCitiesGroup.label = 'ğŸ‡¨ğŸ‡³ ' + t.chinaCities;
            if (citySearch) citySearch.placeholder = t.enterCityName;
            if (roamingStatusText) roamingStatusText.textContent = t.loadingCityInfo;
        }
        
        function generateLanguageOptions() {
            const dropdown = document.getElementById('language-dropdown');
            if (!dropdown) {
                console.error('æ‰¾ä¸åˆ° language-dropdown å…ƒç´ ');
                return;
            }
            
            const languages = i18n.getSupportedLanguages();
            console.log('ç”Ÿæˆè¯­è¨€é€‰é¡¹:', languages);
            
            dropdown.innerHTML = languages.map(lang => `
                <div class="language-option ${lang.code === currentLanguage ? 'active' : ''}" 
                     onclick="changeLanguage('${lang.code}')">
                    <span class="language-flag">${lang.flag}</span>
                    <span class="language-name">${lang.name}</span>
                </div>
            `).join('');
            
            console.log('è¯­è¨€é€‰é¡¹ç”Ÿæˆå®Œæˆï¼Œå…±', languages.length, 'ç§è¯­è¨€');
        }
        
        function changeLanguage(langCode) {
            if (i18n.changeLanguage(langCode)) {
                currentLanguage = langCode;
                // è®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œä¾›iframeè®¿é—®
                window.currentLanguage = langCode;
                updateLanguageUI();
                generateLanguageOptions();
                updateLanguageButton();
                toggleLanguageDropdown();
                
                // è§¦å‘è¯­è¨€å˜åŒ–äº‹ä»¶ï¼Œé€šçŸ¥iframe
                window.dispatchEvent(new CustomEvent('languageChanged', { 
                    detail: { language: langCode } 
                }));
            }
        }
        
        function updateLanguageButton() {
            const currentLang = i18n.getCurrentLanguage();
            const langData = i18n.getSupportedLanguages().find(lang => lang.code === currentLang);
            if (langData) {
                const button = document.querySelector('.language-button');
                if (button) {
                    button.innerHTML = `${langData.flag} ${langData.name}`;
                }
            }
        }
        
        
        function checkAuthStatus() {
            const token = localStorage.getItem('access_token');
            if (token) {
                // éªŒè¯tokenå¹¶è·å–ç”¨æˆ·ä¿¡æ¯
                fetchUserInfo();
            } else {
                updateUserUI(null);
            }
        }
        
        async function fetchUserInfo() {
            try {
                const token = localStorage.getItem('access_token');
                const response = await fetch('/api/auth/me', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    currentUser = user;
                    updateUserUI(user);
                } else {
                    // Tokenæ— æ•ˆï¼Œæ¸…é™¤æœ¬åœ°å­˜å‚¨
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user_id');
                    updateUserUI(null);
                }
            } catch (error) {
                console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
                updateUserUI(null);
            }
        }
        
        function updateUserUI(user) {
            const t = translations[currentLanguage] || translations['zh'];
            
            const userNameEl = document.getElementById('user-name');
            const userEmailEl = document.getElementById('user-email');
            const loginBtnEl = document.getElementById('login-btn');
            const registerBtnEl = document.getElementById('register-btn');
            const logoutBtnEl = document.getElementById('logout-btn');
            
            if (user) {
                if (userNameEl) userNameEl.textContent = user.username;
                if (userEmailEl) userEmailEl.textContent = user.email;
                if (loginBtnEl) loginBtnEl.classList.add('hidden');
                if (registerBtnEl) registerBtnEl.classList.add('hidden');
                if (logoutBtnEl) logoutBtnEl.classList.remove('hidden');
            } else {
                if (userNameEl) userNameEl.textContent = t.guest || 'æ¸¸å®¢';
                if (userEmailEl) userEmailEl.textContent = t.notLoggedIn || 'æœªç™»å½•';
                if (loginBtnEl) loginBtnEl.classList.remove('hidden');
                if (registerBtnEl) registerBtnEl.classList.remove('hidden');
                if (logoutBtnEl) logoutBtnEl.classList.add('hidden');
            }
            
            console.log('ç”¨æˆ·ç•Œé¢æ›´æ–°å®Œæˆ:', user ? 'å·²ç™»å½•' : 'æœªç™»å½•');
        }
        
        function showAuthModal(type) {
            const modal = document.getElementById('auth-modal');
            modal.classList.remove('hidden');
            
            // éšè—ç”¨æˆ·èœå•
            const userDropdown = document.getElementById('user-dropdown');
            if (userDropdown) {
                userDropdown.classList.add('hidden');
            }
            
            // é€šçŸ¥iframeåˆ‡æ¢æ ‡ç­¾é¡µ
            const iframe = modal.querySelector('iframe');
            iframe.onload = function() {
                iframe.contentWindow.postMessage({ action: 'switchTab', tab: type }, '*');
            };
        }
        
        function closeAuthModal() {
            const modal = document.getElementById('auth-modal');
            modal.classList.add('hidden');
        }
        
        async function logout() {
            try {
                const token = localStorage.getItem('access_token');
                if (token) {
                    await fetch('/api/auth/logout', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                }
            } catch (error) {
                console.error('ç™»å‡ºå¤±è´¥:', error);
            } finally {
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                localStorage.removeItem('access_token');
                localStorage.removeItem('user_id');
                currentUser = null;
                updateUserUI(null);
                toggleUserMenu();
            }
        }
        
        function setupAuthEventListeners() {
            // ç›‘å¬æ¥è‡ªiframeçš„æ¶ˆæ¯
            window.addEventListener('message', function(event) {
                if (event.data.action === 'authSuccess') {
                    closeAuthModal();
                    checkAuthStatus();
                }
                // ç›‘å¬å…³é—­è®¤è¯æ¨¡æ€æ¡†çš„æ¶ˆæ¯
                if (event.data.action === 'closeAuthModal') {
                    closeAuthModal();
                }
            });
            
            // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰èœå•
            document.addEventListener('click', function(e) {
                const languageDropdown = document.getElementById('language-dropdown');
                const languageButton = document.querySelector('.language-button');
                const userDropdown = document.getElementById('user-dropdown');
                const userButton = document.querySelector('.user-button');
                
                if (!languageDropdown.contains(e.target) && !languageButton.contains(e.target)) {
                    languageDropdown.classList.add('hidden');
                }
                
                if (!userDropdown.contains(e.target) && !userButton.contains(e.target)) {
                    userDropdown.classList.add('hidden');
                }
            });
        }
    </script>
</body>
</html>